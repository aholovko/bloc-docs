<?xml version="1.0" encoding="UTF-8" standalone="no"?><svg xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" contentStyleType="text/css" height="957px" preserveAspectRatio="none" style="width:659px;height:957px;" version="1.1" viewBox="0 0 659 957" width="659px" zoomAndPan="magnify"><defs><style type="text/css"><![CDATA[*.f_dddddd_222222 {fill:#dddddd;}*.s_181818_e7e7e7 {stroke:#181818;}*.f_000000_ffffff {fill:#000000;}*.f_ffffff_000000 {fill:#ffffff;}*.s_000000_ffffff {stroke:#000000;}*.f_181818_e7e7e7 {fill:#181818;}*.f_feffdd_333333 {fill:#feffdd;}*.f_eeeeee_555555 {fill:#eeeeee;}@media (prefers-color-scheme:dark) {*.f_dddddd_222222 {fill:#222222;}*.s_181818_e7e7e7 {stroke:#e7e7e7;}*.f_000000_ffffff {fill:#ffffff;}*.f_ffffff_000000 {fill:#000000;}*.s_000000_ffffff {stroke:#ffffff;}*.f_181818_e7e7e7 {fill:#e7e7e7;}*.f_feffdd_333333 {fill:#333333;}*.f_eeeeee_555555 {fill:#555555;}}]]></style></defs><g><rect class="f_dddddd_222222 s_181818_e7e7e7" height="938.0391" style="stroke-width:0.5;" width="395" x="1" y="6"/><text class="f_000000_ffffff" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="79" x="159" y="18.0669">Instance 1</text><rect class="f_ffffff_000000 s_181818_e7e7e7" height="29.1328" style="stroke-width:1.0;" width="10" x="37.5" y="129.8594"/><rect class="f_ffffff_000000 s_181818_e7e7e7" height="58.2656" style="stroke-width:1.0;" width="10" x="37.5" y="312.9219"/><rect class="f_ffffff_000000 s_181818_e7e7e7" height="29.1328" style="stroke-width:1.0;" width="10" x="37.5" y="815.3125"/><rect class="f_ffffff_000000 s_181818_e7e7e7" height="502.3906" style="stroke-width:1.0;" width="10" x="314" y="342.0547"/><rect class="f_ffffff_000000 s_181818_e7e7e7" height="109.6641" style="stroke-width:1.0;" width="10" x="483" y="203.2578"/><rect class="f_ffffff_000000 s_181818_e7e7e7" height="29.1328" style="stroke-width:1.0;" width="10" x="483" y="415.4531"/><rect class="f_ffffff_000000 s_181818_e7e7e7" height="29.1328" style="stroke-width:1.0;" width="10" x="483" y="537.1172"/><rect class="f_ffffff_000000 s_181818_e7e7e7" height="29.1328" style="stroke-width:1.0;" width="10" x="483" y="684.7813"/><rect class="f_ffffff_000000 s_181818_e7e7e7" height="29.1328" style="stroke-width:1.0;" width="10" x="483" y="743.0469"/><rect class="f_ffffff_000000 s_181818_e7e7e7" height="29.1328" style="stroke-width:1.0;" width="10" x="574" y="619.5156"/><rect class="s_000000_ffffff" height="327.5938" style="stroke-width:1.5;fill:none;" width="437" x="216" y="459.5859"/><rect class="s_000000_ffffff" height="296.4609" style="stroke-width:1.5;fill:none;" width="417" x="226" y="483.7188"/><rect class="s_000000_ffffff" height="75.3984" style="stroke-width:1.5;fill:none;" width="397" x="236" y="581.25"/><line class="s_181818_e7e7e7" style="stroke-width:0.5;fill:none;stroke-dasharray:5.0,5.0;" x1="42" x2="42" y1="83.5938" y2="862.4453"/><line class="s_181818_e7e7e7" style="stroke-width:0.5;fill:none;stroke-dasharray:5.0,5.0;" x1="192" x2="192" y1="83.5938" y2="862.4453"/><line class="s_181818_e7e7e7" style="stroke-width:0.5;fill:none;stroke-dasharray:5.0,5.0;" x1="319" x2="319" y1="83.5938" y2="862.4453"/><line class="s_181818_e7e7e7" style="stroke-width:0.5;fill:none;stroke-dasharray:5.0,5.0;" x1="488" x2="488" y1="83.5938" y2="862.4453"/><line class="s_181818_e7e7e7" style="stroke-width:0.5;fill:none;stroke-dasharray:5.0,5.0;" x1="579" x2="579" y1="83.5938" y2="862.4453"/><rect class="s_181818_e7e7e7" fill="#E2E2F0" height="46.5938" rx="2.5" ry="2.5" style="stroke-width:0.5;" width="75" x="5" y="36"/><text class="f_000000_ffffff" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="33" x="26" y="55.9951">Task</text><text class="f_000000_ffffff" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="61" x="12" y="72.292">Manager</text><rect class="s_181818_e7e7e7" fill="#E2E2F0" height="46.5938" rx="2.5" ry="2.5" style="stroke-width:0.5;" width="75" x="5" y="861.4453"/><text class="f_000000_ffffff" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="33" x="26" y="881.4404">Task</text><text class="f_000000_ffffff" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="61" x="12" y="897.7373">Manager</text><rect class="s_181818_e7e7e7" fill="#E2E2F0" height="46.5938" rx="2.5" ry="2.5" style="stroke-width:0.5;" width="87" x="149" y="36"/><text class="f_000000_ffffff" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="73" x="156" y="55.9951">Operation</text><text class="f_000000_ffffff" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="45" x="170" y="72.292">Queue</text><rect class="s_181818_e7e7e7" fill="#E2E2F0" height="46.5938" rx="2.5" ry="2.5" style="stroke-width:0.5;" width="87" x="149" y="861.4453"/><text class="f_000000_ffffff" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="73" x="156" y="881.4404">Operation</text><text class="f_000000_ffffff" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="45" x="170" y="897.7373">Queue</text><rect class="s_181818_e7e7e7" fill="#E2E2F0" height="46.5938" rx="2.5" ry="2.5" style="stroke-width:0.5;" width="146" x="246" y="36"/><text class="f_000000_ffffff" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="132" x="253" y="55.9951">op-queue-monitor</text><text class="f_000000_ffffff" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="33" x="302.5" y="72.292">Task</text><rect class="s_181818_e7e7e7" fill="#E2E2F0" height="46.5938" rx="2.5" ry="2.5" style="stroke-width:0.5;" width="146" x="246" y="861.4453"/><text class="f_000000_ffffff" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="132" x="253" y="881.4404">op-queue-monitor</text><text class="f_000000_ffffff" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="33" x="302.5" y="897.7373">Task</text><text class="f_000000_ffffff" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="68" x="451" y="63.9951">op-queue</text><text class="f_000000_ffffff" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="21" x="474.5" y="80.292">DB</text><path class="s_181818_e7e7e7" d="M470,15 C470,5 488,5 488,5 C488,5 506,5 506,15 L506,41 C506,51 488,51 488,51 C488,51 470,51 470,41 L470,15 " fill="#E2E2F0" style="stroke-width:1.5;"/><path class="s_181818_e7e7e7" d="M470,15 C470,25 488,25 488,25 C488,25 506,25 506,15 " fill="none" style="stroke-width:1.5;"/><text class="f_000000_ffffff" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="68" x="451" y="874.4404">op-queue</text><text class="f_000000_ffffff" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="21" x="474.5" y="890.7373">DB</text><path class="s_181818_e7e7e7" d="M470,904.0391 C470,894.0391 488,894.0391 488,894.0391 C488,894.0391 506,894.0391 506,904.0391 L506,930.0391 C506,940.0391 488,940.0391 488,940.0391 C488,940.0391 470,940.0391 470,930.0391 L470,904.0391 " fill="#E2E2F0" style="stroke-width:1.5;"/><path class="s_181818_e7e7e7" d="M470,904.0391 C470,914.0391 488,914.0391 488,914.0391 C488,914.0391 506,914.0391 506,904.0391 " fill="none" style="stroke-width:1.5;"/><path class="s_181818_e7e7e7" d="M540,41 L618,41 C623,41 623,62.2969 623,62.2969 C623,62.2969 623,83.5938 618,83.5938 L540,83.5938 C535,83.5938 535,62.2969 535,62.2969 C535,62.2969 535,41 540,41 " fill="#E2E2F0" style="stroke-width:0.5;"/><path class="s_181818_e7e7e7" d="M618,41 C613,41 613,62.2969 613,62.2969 C613,83.5938 618,83.5938 618,83.5938 " fill="none" style="stroke-width:0.5;"/><text class="f_000000_ffffff" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="42" x="553" y="58.9951">AMQP</text><text class="f_000000_ffffff" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="68" x="540" y="75.292">op-queue</text><path class="s_181818_e7e7e7" d="M540,861.4453 L618,861.4453 C623,861.4453 623,882.7422 623,882.7422 C623,882.7422 623,904.0391 618,904.0391 L540,904.0391 C535,904.0391 535,882.7422 535,882.7422 C535,882.7422 535,861.4453 540,861.4453 " fill="#E2E2F0" style="stroke-width:0.5;"/><path class="s_181818_e7e7e7" d="M618,861.4453 C613,861.4453 613,882.7422 613,882.7422 C613,904.0391 618,904.0391 618,904.0391 " fill="none" style="stroke-width:0.5;"/><text class="f_000000_ffffff" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="42" x="553" y="879.4404">AMQP</text><text class="f_000000_ffffff" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="68" x="540" y="895.7373">op-queue</text><rect class="f_ffffff_000000 s_181818_e7e7e7" height="29.1328" style="stroke-width:1.0;" width="10" x="37.5" y="129.8594"/><rect class="f_ffffff_000000 s_181818_e7e7e7" height="58.2656" style="stroke-width:1.0;" width="10" x="37.5" y="312.9219"/><rect class="f_ffffff_000000 s_181818_e7e7e7" height="29.1328" style="stroke-width:1.0;" width="10" x="37.5" y="815.3125"/><rect class="f_ffffff_000000 s_181818_e7e7e7" height="502.3906" style="stroke-width:1.0;" width="10" x="314" y="342.0547"/><rect class="f_ffffff_000000 s_181818_e7e7e7" height="109.6641" style="stroke-width:1.0;" width="10" x="483" y="203.2578"/><rect class="f_ffffff_000000 s_181818_e7e7e7" height="29.1328" style="stroke-width:1.0;" width="10" x="483" y="415.4531"/><rect class="f_ffffff_000000 s_181818_e7e7e7" height="29.1328" style="stroke-width:1.0;" width="10" x="483" y="537.1172"/><rect class="f_ffffff_000000 s_181818_e7e7e7" height="29.1328" style="stroke-width:1.0;" width="10" x="483" y="684.7813"/><rect class="f_ffffff_000000 s_181818_e7e7e7" height="29.1328" style="stroke-width:1.0;" width="10" x="483" y="743.0469"/><rect class="f_ffffff_000000 s_181818_e7e7e7" height="29.1328" style="stroke-width:1.0;" width="10" x="574" y="619.5156"/><polygon class="f_181818_e7e7e7 s_181818_e7e7e7" points="58.5,125.8594,48.5,129.8594,58.5,133.8594,54.5,129.8594" style="stroke-width:1.0;"/><line class="s_181818_e7e7e7" style="stroke-width:1.0;" x1="52.5" x2="191.5" y1="129.8594" y2="129.8594"/><text class="f_000000_ffffff" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="83" x="64.5" y="109.6606">RegisterTask</text><text class="f_000000_ffffff" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="126" x="64.5" y="124.7935">(op-queue-monitor)</text><polygon class="f_181818_e7e7e7 s_181818_e7e7e7" points="180.5,154.9922,190.5,158.9922,180.5,162.9922,184.5,158.9922" style="stroke-width:1.0;"/><line class="s_181818_e7e7e7" style="stroke-width:1.0;stroke-dasharray:2.0,2.0;" x1="42.5" x2="186.5" y1="158.9922" y2="158.9922"/><text class="f_000000_ffffff" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="15" x="49.5" y="153.9263">ok</text><polygon class="f_181818_e7e7e7 s_181818_e7e7e7" points="471,199.2578,481,203.2578,471,207.2578,475,203.2578" style="stroke-width:1.0;"/><line class="s_181818_e7e7e7" style="stroke-width:1.0;" x1="192.5" x2="477" y1="203.2578" y2="203.2578"/><text class="f_000000_ffffff" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="190" x="199.5" y="183.0591">Put(taskID=uniqueInstanceID,</text><text class="f_000000_ffffff" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="127" x="199.5" y="198.1919">updatedTime=now)</text><path class="f_feffdd_333333 s_181818_e7e7e7" d="M397,216.2578 L397,286.2578 L578,286.2578 L578,226.2578 L568,216.2578 L397,216.2578 " style="stroke-width:0.5;"/><path class="f_feffdd_333333 s_181818_e7e7e7" d="M568,216.2578 L568,226.2578 L578,226.2578 L568,216.2578 " style="stroke-width:0.5;"/><text class="f_000000_ffffff" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="123" x="403" y="233.3247">Add a task entry to</text><text class="f_000000_ffffff" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="141" x="403" y="248.4575">the database with the</text><text class="f_000000_ffffff" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="160" x="403" y="263.5903">unique ID of the instance</text><text class="f_000000_ffffff" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="132" x="403" y="278.7231">and the current time</text><polygon class="f_181818_e7e7e7 s_181818_e7e7e7" points="203.5,308.9219,193.5,312.9219,203.5,316.9219,199.5,312.9219" style="stroke-width:1.0;"/><line class="s_181818_e7e7e7" style="stroke-width:1.0;stroke-dasharray:2.0,2.0;" x1="197.5" x2="487" y1="312.9219" y2="312.9219"/><text class="f_000000_ffffff" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="15" x="209.5" y="307.856">ok</text><polygon class="f_181818_e7e7e7 s_181818_e7e7e7" points="302,338.0547,312,342.0547,302,346.0547,306,342.0547" style="stroke-width:1.0;"/><line class="s_181818_e7e7e7" style="stroke-width:1.0;" x1="47.5" x2="308" y1="342.0547" y2="342.0547"/><text class="f_000000_ffffff" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="21" x="54.5" y="336.9888">run</text><polygon class="f_181818_e7e7e7 s_181818_e7e7e7" points="53.5,367.1875,43.5,371.1875,53.5,375.1875,49.5,371.1875" style="stroke-width:1.0;"/><line class="s_181818_e7e7e7" style="stroke-width:1.0;stroke-dasharray:2.0,2.0;" x1="47.5" x2="313" y1="371.1875" y2="371.1875"/><text class="f_000000_ffffff" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="15" x="59.5" y="366.1216">ok</text><polygon class="f_181818_e7e7e7 s_181818_e7e7e7" points="471,411.4531,481,415.4531,471,419.4531,475,415.4531" style="stroke-width:1.0;"/><line class="s_181818_e7e7e7" style="stroke-width:1.0;" x1="324" x2="477" y1="415.4531" y2="415.4531"/><text class="f_000000_ffffff" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="99" x="331" y="395.2544">Query tasks for</text><text class="f_000000_ffffff" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="99" x="331" y="410.3872">other instances</text><polygon class="f_181818_e7e7e7 s_181818_e7e7e7" points="335,440.5859,325,444.5859,335,448.5859,331,444.5859" style="stroke-width:1.0;"/><line class="s_181818_e7e7e7" style="stroke-width:1.0;stroke-dasharray:2.0,2.0;" x1="329" x2="487" y1="444.5859" y2="444.5859"/><text class="f_000000_ffffff" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="34" x="341" y="439.52">tasks</text><path class="f_eeeeee_555555 s_000000_ffffff" d="M216,459.5859 L294,459.5859 L294,466.7188 L284,476.7188 L216,476.7188 L216,459.5859 " style="stroke-width:1.5;"/><rect class="s_000000_ffffff" fill="none" height="327.5938" style="stroke-width:1.5;" width="437" x="216" y="459.5859"/><text class="f_000000_ffffff" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="33" x="231" y="472.6528">loop</text><text class="f_000000_ffffff" font-family="sans-serif" font-size="11" font-weight="bold" lengthAdjust="spacing" textLength="165" x="309" y="471.7964">[For each taskN in tasks]</text><path class="f_eeeeee_555555 s_000000_ffffff" d="M226,483.7188 L292,483.7188 L292,490.8516 L282,500.8516 L226,500.8516 L226,483.7188 " style="stroke-width:1.5;"/><rect class="s_000000_ffffff" fill="none" height="296.4609" style="stroke-width:1.5;" width="417" x="226" y="483.7188"/><text class="f_000000_ffffff" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="21" x="241" y="496.7856">alt</text><text class="f_000000_ffffff" font-family="sans-serif" font-size="11" font-weight="bold" lengthAdjust="spacing" textLength="130" x="307" y="495.9292">[TaskN has expired]</text><polygon class="f_181818_e7e7e7 s_181818_e7e7e7" points="471,533.1172,481,537.1172,471,541.1172,475,537.1172" style="stroke-width:1.0;"/><line class="s_181818_e7e7e7" style="stroke-width:1.0;" x1="324" x2="477" y1="537.1172" y2="537.1172"/><text class="f_000000_ffffff" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="111" x="331" y="516.9185">Query operations</text><text class="f_000000_ffffff" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="140" x="331" y="532.0513">associated with taskN</text><polygon class="f_181818_e7e7e7 s_181818_e7e7e7" points="335,562.25,325,566.25,335,570.25,331,566.25" style="stroke-width:1.0;"/><line class="s_181818_e7e7e7" style="stroke-width:1.0;stroke-dasharray:2.0,2.0;" x1="329" x2="487" y1="566.25" y2="566.25"/><text class="f_000000_ffffff" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="23" x="341" y="561.1841">ops</text><path class="f_eeeeee_555555 s_000000_ffffff" d="M236,581.25 L314,581.25 L314,588.3828 L304,598.3828 L236,598.3828 L236,581.25 " style="stroke-width:1.5;"/><rect class="s_000000_ffffff" fill="none" height="75.3984" style="stroke-width:1.5;" width="397" x="236" y="581.25"/><text class="f_000000_ffffff" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="33" x="251" y="594.3169">loop</text><text class="f_000000_ffffff" font-family="sans-serif" font-size="11" font-weight="bold" lengthAdjust="spacing" textLength="132" x="329" y="593.4604">[For each op in ops]</text><polygon class="f_181818_e7e7e7 s_181818_e7e7e7" points="562,615.5156,572,619.5156,562,623.5156,566,619.5156" style="stroke-width:1.0;"/><line class="s_181818_e7e7e7" style="stroke-width:1.0;" x1="324" x2="568" y1="619.5156" y2="619.5156"/><text class="f_000000_ffffff" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="71" x="331" y="614.4497">Publish(op)</text><polygon class="f_181818_e7e7e7 s_181818_e7e7e7" points="335,644.6484,325,648.6484,335,652.6484,331,648.6484" style="stroke-width:1.0;"/><line class="s_181818_e7e7e7" style="stroke-width:1.0;stroke-dasharray:2.0,2.0;" x1="329" x2="578" y1="648.6484" y2="648.6484"/><text class="f_000000_ffffff" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="15" x="341" y="643.5825">ok</text><polygon class="f_181818_e7e7e7 s_181818_e7e7e7" points="471,680.7813,481,684.7813,471,688.7813,475,684.7813" style="stroke-width:1.0;"/><line class="s_181818_e7e7e7" style="stroke-width:1.0;" x1="324" x2="477" y1="684.7813" y2="684.7813"/><text class="f_000000_ffffff" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="75" x="331" y="679.7153">Delete(ops)</text><polygon class="f_181818_e7e7e7 s_181818_e7e7e7" points="335,709.9141,325,713.9141,335,717.9141,331,713.9141" style="stroke-width:1.0;"/><line class="s_181818_e7e7e7" style="stroke-width:1.0;stroke-dasharray:2.0,2.0;" x1="329" x2="487" y1="713.9141" y2="713.9141"/><text class="f_000000_ffffff" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="15" x="341" y="708.8481">ok</text><polygon class="f_181818_e7e7e7 s_181818_e7e7e7" points="471,739.0469,481,743.0469,471,747.0469,475,743.0469" style="stroke-width:1.0;"/><line class="s_181818_e7e7e7" style="stroke-width:1.0;" x1="324" x2="477" y1="743.0469" y2="743.0469"/><text class="f_000000_ffffff" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="88" x="331" y="737.981">Delete(taskN)</text><polygon class="f_181818_e7e7e7 s_181818_e7e7e7" points="335,768.1797,325,772.1797,335,776.1797,331,772.1797" style="stroke-width:1.0;"/><line class="s_181818_e7e7e7" style="stroke-width:1.0;stroke-dasharray:2.0,2.0;" x1="329" x2="487" y1="772.1797" y2="772.1797"/><text class="f_000000_ffffff" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="15" x="341" y="767.1138">ok</text><polygon class="f_181818_e7e7e7 s_181818_e7e7e7" points="58.5,811.3125,48.5,815.3125,58.5,819.3125,54.5,815.3125" style="stroke-width:1.0;"/><line class="s_181818_e7e7e7" style="stroke-width:1.0;" x1="52.5" x2="313" y1="815.3125" y2="815.3125"/><text class="f_000000_ffffff" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="32" x="64.5" y="810.2466">done</text><polygon class="f_181818_e7e7e7 s_181818_e7e7e7" points="307,840.4453,317,844.4453,307,848.4453,311,844.4453" style="stroke-width:1.0;"/><line class="s_181818_e7e7e7" style="stroke-width:1.0;stroke-dasharray:2.0,2.0;" x1="42.5" x2="313" y1="844.4453" y2="844.4453"/><text class="f_000000_ffffff" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="15" x="49.5" y="839.3794">ok</text><!--MD5=[cfda50c4d87b8581f0b063d13965fae7]
@startuml
'https://plantuml.com/sequence-diagram

box Instance 1
participant "Task\nManager" as taskMgr1
participant "Operation\nQueue" as handler1
participant "op-queue-monitor\nTask" as task1
end box

database "op-queue\nDB" as opQueueDB

queue "AMQP\nop-queue" as opQueue

handler1 -> taskMgr1: RegisterTask\n(op-queue-monitor)

activate taskMgr1
taskMgr1 - -> handler1: ok
deactivate taskMgr1

handler1 -> opQueueDB: Put(taskID=uniqueInstanceID,\nupdatedTime=now)
activate opQueueDB

  note over opQueueDB
    Add a task entry to
    the database with the
    unique ID of the instance
    and the current time
  end note

  opQueueDB - -> handler1: ok
deactivate opQueueDB

activate taskMgr1
taskMgr1 -> task1: run
activate task1
task1 - -> taskMgr1: ok
deactivate taskMgr1

task1 -> opQueueDB: Query tasks for\nother instances
activate opQueueDB
task1 <- - opQueueDB: tasks
deactivate opQueueDB

loop For each taskN in tasks
  alt TaskN has expired
    task1 -> opQueueDB: Query operations\nassociated with taskN
    activate opQueueDB
      opQueueDB - -> task1: ops
    deactivate opQueueDB

    loop For each op in ops
      task1 -> opQueue: Publish(op)
      activate opQueue
      opQueue - -> task1: ok
      deactivate opQueue
    end loop

    task1 -> opQueueDB: Delete(ops)
    activate opQueueDB
    opQueueDB - -> task1: ok
    deactivate opQueueDB

    task1 -> opQueueDB: Delete(taskN)
    activate opQueueDB
    opQueueDB - -> task1: ok
    deactivate opQueueDB
  end alt
end loop

task1 -> taskMgr1: done
activate taskMgr1
taskMgr1 - -> task1: ok
deactivate taskMgr1

deactivate task1
@enduml

@startuml

box Instance 1
participant "Task\nManager" as taskMgr1
participant "Operation\nQueue" as handler1
participant "op-queue-monitor\nTask" as task1
end box

database "op-queue\nDB" as opQueueDB

queue "AMQP\nop-queue" as opQueue

handler1 -> taskMgr1: RegisterTask\n(op-queue-monitor)

activate taskMgr1
taskMgr1 - -> handler1: ok
deactivate taskMgr1

handler1 -> opQueueDB: Put(taskID=uniqueInstanceID,\nupdatedTime=now)
activate opQueueDB

  note over opQueueDB
    Add a task entry to
    the database with the
    unique ID of the instance
    and the current time
  end note

  opQueueDB - -> handler1: ok
deactivate opQueueDB

activate taskMgr1
taskMgr1 -> task1: run
activate task1
task1 - -> taskMgr1: ok
deactivate taskMgr1

task1 -> opQueueDB: Query tasks for\nother instances
activate opQueueDB
task1 <- - opQueueDB: tasks
deactivate opQueueDB

loop For each taskN in tasks
  alt TaskN has expired
    task1 -> opQueueDB: Query operations\nassociated with taskN
    activate opQueueDB
      opQueueDB - -> task1: ops
    deactivate opQueueDB

    loop For each op in ops
      task1 -> opQueue: Publish(op)
      activate opQueue
      opQueue - -> task1: ok
      deactivate opQueue
    end loop

    task1 -> opQueueDB: Delete(ops)
    activate opQueueDB
    opQueueDB - -> task1: ok
    deactivate opQueueDB

    task1 -> opQueueDB: Delete(taskN)
    activate opQueueDB
    opQueueDB - -> task1: ok
    deactivate opQueueDB
  end alt
end loop

task1 -> taskMgr1: done
activate taskMgr1
taskMgr1 - -> task1: ok
deactivate taskMgr1

deactivate task1
@enduml

PlantUML version 1.2022.2beta5(Unknown compile time)
(GPL source distribution)
Java Runtime: Java(TM) SE Runtime Environment
JVM: Java HotSpot(TM) 64-Bit Server VM
Default Encoding: UTF-8
Language: en
Country: US
--></g></svg>