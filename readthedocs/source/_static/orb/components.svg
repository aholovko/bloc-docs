<?xml version="1.0" encoding="UTF-8" standalone="no"?><svg xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" contentStyleType="text/css" height="891px" preserveAspectRatio="none" style="width:1055px;height:891px;" version="1.1" viewBox="0 0 1055 891" width="1055px" zoomAndPan="magnify"><defs><style type="text/css"><![CDATA[*.s_181818_e7e7e7 {stroke:#181818;}*.f_000000_ffffff {fill:#000000;}*.f_f1f1f1_070707 {fill:#f1f1f1;}*.f_181818_e7e7e7 {fill:#181818;}@media (prefers-color-scheme:dark) {*.s_181818_e7e7e7 {stroke:#e7e7e7;}*.f_000000_ffffff {fill:#ffffff;}*.f_f1f1f1_070707 {fill:#070707;}*.f_181818_e7e7e7 {fill:#e7e7e7;}}]]></style></defs><g><!--MD5=[09cebf8940f732fa2133abd0579f057b]
cluster Domain1--><rect class="s_181818_e7e7e7" height="878" style="stroke-width:1.0;fill:none;" width="836" x="7" y="7"/><path class="s_181818_e7e7e7" d="M88,7 L88,16.2969 L78,26.2969 L7,26.2969 " fill="none" style="stroke-width:1.0;"/><text class="f_000000_ffffff" font-family="sans-serif" font-size="14" font-weight="bold" lengthAdjust="spacing" textLength="71" x="10" y="20.9951">Domain1</text><!--MD5=[d634f2550f9f84f8762d437d8439690d]
entity casdb--><path class="f_f1f1f1_070707 s_181818_e7e7e7" d="M135.5,817 C135.5,807 167,807 167,807 C167,807 198.5,807 198.5,817 L198.5,858.5938 C198.5,868.5938 167,868.5938 167,868.5938 C167,868.5938 135.5,868.5938 135.5,858.5938 L135.5,817 " style="stroke-width:0.5;"/><path class="s_181818_e7e7e7" d="M135.5,817 C135.5,827 167,827 167,827 C167,827 198.5,827 198.5,817 " fill="none" style="stroke-width:0.5;"/><text class="f_000000_ffffff" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="29" x="145.5" y="843.9951">CAS</text><text class="f_000000_ffffff" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="43" x="145.5" y="860.292">(local)</text><!--MD5=[d73fd630ced0fe73a4ad473b74a33a42]
entity ipfs--><path class="f_f1f1f1_070707 s_181818_e7e7e7" d="M40,817 C40,807 70,807 70,807 C70,807 100,807 100,817 L100,858.5938 C100,868.5938 70,868.5938 70,868.5938 C70,868.5938 40,868.5938 40,858.5938 L40,817 " style="stroke-width:0.5;"/><path class="s_181818_e7e7e7" d="M40,817 C40,827 70,827 70,827 C70,827 100,827 100,817 " fill="none" style="stroke-width:0.5;"/><text class="f_000000_ffffff" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="29" x="50" y="843.9951">CAS</text><text class="f_000000_ffffff" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="40" x="50" y="860.292">(IPFS)</text><!--MD5=[9b3a966946ebcb62708be9131288b6cf]
entity opdb--><path class="f_f1f1f1_070707 s_181818_e7e7e7" d="M485,703 C485,693 535,693 535,693 C535,693 585,693 585,703 L585,728.2969 C585,738.2969 535,738.2969 535,738.2969 C535,738.2969 485,738.2969 485,728.2969 L485,703 " style="stroke-width:0.5;"/><path class="s_181818_e7e7e7" d="M485,703 C485,713 535,713 535,713 C535,713 585,713 585,703 " fill="none" style="stroke-width:0.5;"/><text class="f_000000_ffffff" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="80" x="495" y="729.9951">Operations</text><!--MD5=[9b91fbdfe12edcc9101cd9a7a04d0dad]
entity txndb--><path class="f_f1f1f1_070707 s_181818_e7e7e7" d="M252.5,207.5 C252.5,197.5 279,197.5 279,197.5 C279,197.5 305.5,197.5 305.5,207.5 L305.5,249.0938 C305.5,259.0938 279,259.0938 279,259.0938 C279,259.0938 252.5,259.0938 252.5,249.0938 L252.5,207.5 " style="stroke-width:0.5;"/><path class="s_181818_e7e7e7" d="M252.5,207.5 C252.5,217.5 279,217.5 279,217.5 C279,217.5 305.5,217.5 305.5,207.5 " fill="none" style="stroke-width:0.5;"/><text class="f_000000_ffffff" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="26" x="262.5" y="234.4951">DID</text><text class="f_000000_ffffff" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="33" x="262.5" y="250.792">Txns</text><!--MD5=[31db30e5baccdfa6123806a4100c9f5b]
entity apdb--><path class="f_f1f1f1_070707 s_181818_e7e7e7" d="M341,216 C341,206 385,206 385,206 C385,206 429,206 429,216 L429,241.2969 C429,251.2969 385,251.2969 385,251.2969 C385,251.2969 341,251.2969 341,241.2969 L341,216 " style="stroke-width:0.5;"/><path class="s_181818_e7e7e7" d="M341,216 C341,226 385,226 385,226 C385,226 429,226 429,216 " fill="none" style="stroke-width:0.5;"/><text class="f_000000_ffffff" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="68" x="351" y="242.9951">Activities</text><!--MD5=[3b28542fe38a78e3c99147f79f52076e]
entity apoutbox--><rect class="f_f1f1f1_070707 s_181818_e7e7e7" height="62.5938" rx="2.5" ry="2.5" style="stroke-width:0.5;" width="123" x="673.5" y="522"/><rect class="f_f1f1f1_070707 s_181818_e7e7e7" height="10" style="stroke-width:0.5;" width="15" x="776.5" y="527"/><rect class="f_f1f1f1_070707 s_181818_e7e7e7" height="2" style="stroke-width:0.5;" width="4" x="774.5" y="529"/><rect class="f_f1f1f1_070707 s_181818_e7e7e7" height="2" style="stroke-width:0.5;" width="4" x="774.5" y="533"/><text class="f_000000_ffffff" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="83" x="688.5" y="554.9951">ActivityPub</text><text class="f_000000_ffffff" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="53" x="688.5" y="571.292">Outbox</text><!--MD5=[58d9bd7cb9f8a2e5fd76962552a117eb]
entity apinbox--><rect class="f_f1f1f1_070707 s_181818_e7e7e7" height="62.5938" rx="2.5" ry="2.5" style="stroke-width:0.5;" width="123" x="650.5" y="42"/><rect class="f_f1f1f1_070707 s_181818_e7e7e7" height="10" style="stroke-width:0.5;" width="15" x="753.5" y="47"/><rect class="f_f1f1f1_070707 s_181818_e7e7e7" height="2" style="stroke-width:0.5;" width="4" x="751.5" y="49"/><rect class="f_f1f1f1_070707 s_181818_e7e7e7" height="2" style="stroke-width:0.5;" width="4" x="751.5" y="53"/><text class="f_000000_ffffff" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="83" x="665.5" y="74.9951">ActivityPub</text><text class="f_000000_ffffff" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="40" x="665.5" y="91.292">Inbox</text><!--MD5=[aca47b54c1c1bb37bcb57798aa7419aa]
entity aphandler--><rect class="f_f1f1f1_070707 s_181818_e7e7e7" height="62.5938" rx="2.5" ry="2.5" style="stroke-width:0.5;" width="123" x="550.5" y="197"/><rect class="f_f1f1f1_070707 s_181818_e7e7e7" height="10" style="stroke-width:0.5;" width="15" x="653.5" y="202"/><rect class="f_f1f1f1_070707 s_181818_e7e7e7" height="2" style="stroke-width:0.5;" width="4" x="651.5" y="204"/><rect class="f_f1f1f1_070707 s_181818_e7e7e7" height="2" style="stroke-width:0.5;" width="4" x="651.5" y="208"/><text class="f_000000_ffffff" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="83" x="565.5" y="229.9951">ActivityPub</text><text class="f_000000_ffffff" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="55" x="565.5" y="246.292">Handler</text><!--MD5=[34ba27c2a177ac2890ff5d899318f8c6]
entity apinbox_rest--><ellipse class="f_f1f1f1_070707 s_181818_e7e7e7" cx="818" cy="73.5" rx="8" ry="8" style="stroke-width:0.5;"/><text class="f_000000_ffffff" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="46" x="795" y="103.4951">HTTPS</text><!--MD5=[993f000e49d2dd190541e7fe63ba4400]
entity batch_writer--><rect class="f_f1f1f1_070707 s_181818_e7e7e7" height="62.5938" rx="2.5" ry="2.5" style="stroke-width:0.5;" width="86" x="23" y="42"/><rect class="f_f1f1f1_070707 s_181818_e7e7e7" height="10" style="stroke-width:0.5;" width="15" x="89" y="47"/><rect class="f_f1f1f1_070707 s_181818_e7e7e7" height="2" style="stroke-width:0.5;" width="4" x="87" y="49"/><rect class="f_f1f1f1_070707 s_181818_e7e7e7" height="2" style="stroke-width:0.5;" width="4" x="87" y="53"/><text class="f_000000_ffffff" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="42" x="38" y="74.9951">Batch</text><text class="f_000000_ffffff" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="46" x="38" y="91.292">Writer</text><!--MD5=[deaef409d8e87a93d0193a2bc5414cd6]
entity anchor_writer--><rect class="f_f1f1f1_070707 s_181818_e7e7e7" height="62.5938" rx="2.5" ry="2.5" style="stroke-width:0.5;" width="91" x="280.5" y="367"/><rect class="f_f1f1f1_070707 s_181818_e7e7e7" height="10" style="stroke-width:0.5;" width="15" x="351.5" y="372"/><rect class="f_f1f1f1_070707 s_181818_e7e7e7" height="2" style="stroke-width:0.5;" width="4" x="349.5" y="374"/><rect class="f_f1f1f1_070707 s_181818_e7e7e7" height="2" style="stroke-width:0.5;" width="4" x="349.5" y="378"/><text class="f_000000_ffffff" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="51" x="295.5" y="399.9951">Anchor</text><text class="f_000000_ffffff" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="46" x="295.5" y="416.292">Writer</text><!--MD5=[1379db5318089dbdfabb53cc9a236c51]
entity observer--><rect class="f_f1f1f1_070707 s_181818_e7e7e7" height="46.2969" rx="2.5" ry="2.5" style="stroke-width:0.5;" width="106" x="273" y="692.5"/><rect class="f_f1f1f1_070707 s_181818_e7e7e7" height="10" style="stroke-width:0.5;" width="15" x="359" y="697.5"/><rect class="f_f1f1f1_070707 s_181818_e7e7e7" height="2" style="stroke-width:0.5;" width="4" x="357" y="699.5"/><rect class="f_f1f1f1_070707 s_181818_e7e7e7" height="2" style="stroke-width:0.5;" width="4" x="357" y="703.5"/><text class="f_000000_ffffff" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="66" x="288" y="725.4951">Observer</text><!--MD5=[1703aff3b908b7f48e49671034c72a52]
entity cas--><rect class="f_f1f1f1_070707 s_181818_e7e7e7" height="46.2969" rx="2.5" ry="2.5" style="stroke-width:0.5;" width="69" x="85.5" y="692.5"/><rect class="f_f1f1f1_070707 s_181818_e7e7e7" height="10" style="stroke-width:0.5;" width="15" x="134.5" y="697.5"/><rect class="f_f1f1f1_070707 s_181818_e7e7e7" height="2" style="stroke-width:0.5;" width="4" x="132.5" y="699.5"/><rect class="f_f1f1f1_070707 s_181818_e7e7e7" height="2" style="stroke-width:0.5;" width="4" x="132.5" y="703.5"/><text class="f_000000_ffffff" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="29" x="100.5" y="725.4951">CAS</text><!--MD5=[f2fbfbe476ce02d5477f243163075997]
entity vct--><rect class="f_f1f1f1_070707 s_181818_e7e7e7" height="46.2969" rx="2.5" ry="2.5" style="stroke-width:0.5;" width="69" x="460.5" y="375.5"/><rect class="f_f1f1f1_070707 s_181818_e7e7e7" height="10" style="stroke-width:0.5;" width="15" x="509.5" y="380.5"/><rect class="f_f1f1f1_070707 s_181818_e7e7e7" height="2" style="stroke-width:0.5;" width="4" x="507.5" y="382.5"/><rect class="f_f1f1f1_070707 s_181818_e7e7e7" height="2" style="stroke-width:0.5;" width="4" x="507.5" y="386.5"/><text class="f_000000_ffffff" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="29" x="475.5" y="408.4951">VCT</text><!--MD5=[bb7d9cc4d175465c2339e28885ba1e3d]
entity observer_queue--><path class="f_f1f1f1_070707 s_181818_e7e7e7" d="M288,532 L364,532 C369,532 369,553.2969 369,553.2969 C369,553.2969 369,574.5938 364,574.5938 L288,574.5938 C283,574.5938 283,553.2969 283,553.2969 C283,553.2969 283,532 288,532 " style="stroke-width:0.5;"/><path class="s_181818_e7e7e7" d="M364,532 C359,532 359,553.2969 359,553.2969 C359,574.5938 364,574.5938 364,574.5938 " fill="none" style="stroke-width:0.5;"/><text class="f_000000_ffffff" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="66" x="288" y="549.9951">Observer</text><text class="f_000000_ffffff" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="45" x="288" y="566.292">Queue</text><!--MD5=[2f1867d4723f569b3fd3d711569e7e52]
entity op_queue--><path class="f_f1f1f1_070707 s_181818_e7e7e7" d="M149.5,52 L232.5,52 C237.5,52 237.5,73.2969 237.5,73.2969 C237.5,73.2969 237.5,94.5938 232.5,94.5938 L149.5,94.5938 C144.5,94.5938 144.5,73.2969 144.5,73.2969 C144.5,73.2969 144.5,52 149.5,52 " style="stroke-width:0.5;"/><path class="s_181818_e7e7e7" d="M232.5,52 C227.5,52 227.5,73.2969 227.5,73.2969 C227.5,94.5938 232.5,94.5938 232.5,94.5938 " fill="none" style="stroke-width:0.5;"/><text class="f_000000_ffffff" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="73" x="149.5" y="69.9951">Operation</text><text class="f_000000_ffffff" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="45" x="149.5" y="86.292">Queue</text><!--MD5=[56962a892b8ba6b23a0022412468165d]
entity opwriter--><rect class="f_f1f1f1_070707 s_181818_e7e7e7" height="62.5938" rx="2.5" ry="2.5" style="stroke-width:0.5;" width="113" x="342.5" y="42"/><rect class="f_f1f1f1_070707 s_181818_e7e7e7" height="10" style="stroke-width:0.5;" width="15" x="435.5" y="47"/><rect class="f_f1f1f1_070707 s_181818_e7e7e7" height="2" style="stroke-width:0.5;" width="4" x="433.5" y="49"/><rect class="f_f1f1f1_070707 s_181818_e7e7e7" height="2" style="stroke-width:0.5;" width="4" x="433.5" y="53"/><text class="f_000000_ffffff" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="73" x="357.5" y="74.9951">Operation</text><text class="f_000000_ffffff" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="46" x="357.5" y="91.292">Writer</text><!--MD5=[2895277b7966f984a52569b0f63e34db]
entity opwriter_rest--><ellipse class="f_f1f1f1_070707 s_181818_e7e7e7" cx="500" cy="73.5" rx="8" ry="8" style="stroke-width:0.5;"/><text class="f_000000_ffffff" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="46" x="477" y="103.4951">HTTPS</text><!--MD5=[1ec31353849fe543383d7abfb5766f2f]
entity didresolver--><rect class="f_f1f1f1_070707 s_181818_e7e7e7" height="62.5938" rx="2.5" ry="2.5" style="stroke-width:0.5;" width="102" x="483" y="522"/><rect class="f_f1f1f1_070707 s_181818_e7e7e7" height="10" style="stroke-width:0.5;" width="15" x="565" y="527"/><rect class="f_f1f1f1_070707 s_181818_e7e7e7" height="2" style="stroke-width:0.5;" width="4" x="563" y="529"/><rect class="f_f1f1f1_070707 s_181818_e7e7e7" height="2" style="stroke-width:0.5;" width="4" x="563" y="533"/><text class="f_000000_ffffff" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="26" x="498" y="554.9951">DID</text><text class="f_000000_ffffff" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="62" x="498" y="571.292">Resolver</text><!--MD5=[f6be0b179b4fb0d2fcf95d7defd92fd2]
entity didresolver_rest--><ellipse class="f_f1f1f1_070707 s_181818_e7e7e7" cx="629" cy="553.5" rx="8" ry="8" style="stroke-width:0.5;"/><text class="f_000000_ffffff" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="46" x="606" y="583.4951">HTTPS</text><!--MD5=[f141b8d23c47a078a0c2dc56c0ec508d]
entity kms--><rect class="f_f1f1f1_070707 s_181818_e7e7e7" height="46.2969" rx="2.5" ry="2.5" style="stroke-width:0.5;" width="71" x="544.5" y="50.5"/><rect class="f_f1f1f1_070707 s_181818_e7e7e7" height="10" style="stroke-width:0.5;" width="15" x="595.5" y="55.5"/><rect class="f_f1f1f1_070707 s_181818_e7e7e7" height="2" style="stroke-width:0.5;" width="4" x="593.5" y="57.5"/><rect class="f_f1f1f1_070707 s_181818_e7e7e7" height="2" style="stroke-width:0.5;" width="4" x="593.5" y="61.5"/><text class="f_000000_ffffff" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="31" x="559.5" y="83.4951">KMS</text><!--MD5=[e3af19b850eaaf61e7ec88da8daefc3f]
entity domain1admin--><ellipse class="s_181818_e7e7e7" cx="916" cy="808.5" fill="#F0FFFF" rx="8" ry="8" style="stroke-width:0.5;"/><path class="s_181818_e7e7e7" d="M916,816.5 L916,843.5 M903,824.5 L929,824.5 M916,843.5 L903,858.5 M916,843.5 L929,858.5 " fill="none" style="stroke-width:0.5;"/><text class="f_000000_ffffff" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="114" x="859" y="872.9951">Domain1 Admin</text><!--MD5=[68ee199d46f3ce3c48339370f100a1e5]
entity domain2--><rect class="s_181818_e7e7e7" fill="#F0FFFF" height="46.2969" rx="2.5" ry="2.5" style="stroke-width:0.5;" width="103" x="913.5" y="530.5"/><path class="s_181818_e7e7e7" d="M947.8333,530.5 L947.8333,535.5 L940.8333,542.5 L913.5,542.5 " fill="none" style="stroke-width:0.5;"/><text class="f_000000_ffffff" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="63" x="928.5" y="563.4951">Domain2</text><!--MD5=[de459b4515f3b440caf8e354e9d5f652]
entity domain3--><rect class="s_181818_e7e7e7" fill="#F0FFFF" height="46.2969" rx="2.5" ry="2.5" style="stroke-width:0.5;" width="104" x="945" y="692.5"/><path class="s_181818_e7e7e7" d="M979.6667,692.5 L979.6667,697.5 L972.6667,704.5 L945,704.5 " fill="none" style="stroke-width:0.5;"/><text class="f_000000_ffffff" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="64" x="960" y="725.4951">Domain3</text><!--MD5=[6a09cb472746656e7b1534ae629cf0a7]
link apinbox to apinbox_rest--><path class="s_181818_e7e7e7" d="M773.751,73.5 C778.862,73.5 782.667,73.5 782.667,73.5 C782.667,73.5 798.248,73.5 808.717,73.5 " fill="none" id="apinbox-apinbox_rest" style="stroke-width:1.0;"/><!--MD5=[095d081c23bb39035f1a98549a1e4cac]
link apinbox to aphandler--><path class="s_181818_e7e7e7" d="M698.792,105.044 C687.141,131.988 672,167 672,167 C672,167 659.662,179.44 646.176,193.039 " fill="none" id="apinbox-to-aphandler" style="stroke-width:1.0;"/><polygon class="f_181818_e7e7e7 s_181818_e7e7e7" points="642.352,196.896,651.53,193.3234,645.8732,193.3462,645.8504,187.6894,642.352,196.896" style="stroke-width:1.0;"/><!--MD5=[f10bda5d257ed768a8b9681947c010c4]
reverse link apdb to aphandler--><path class="s_181818_e7e7e7" d="M434.406,228.5 C468.491,228.5 514.05,228.5 550.489,228.5 " fill="none" id="apdb-backto-aphandler" style="stroke-width:1.0;"/><polygon class="f_181818_e7e7e7 s_181818_e7e7e7" points="429.037,228.5,438.037,232.5,434.037,228.5,438.037,224.5,429.037,228.5" style="stroke-width:1.0;"/><text class="f_000000_ffffff" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="85" x="447.25" y="221.5669">Store activity</text><!--MD5=[f9817d5f8ce643ff21c6596a57071db4]
link opwriter to opwriter_rest--><path class="s_181818_e7e7e7" d="M455.681,73.5 C461.599,73.5 466.333,73.5 466.333,73.5 C466.333,73.5 480.832,73.5 490.8,73.5 " fill="none" id="opwriter-opwriter_rest" style="stroke-width:1.0;"/><!--MD5=[f52d3a17e6ec7f8ab241b47c3b49ea79]
link didresolver to didresolver_rest--><path class="s_181818_e7e7e7" d="M585.181,553.5 C591.697,553.5 597.333,553.5 597.333,553.5 C597.333,553.5 610.329,553.5 619.67,553.5 " fill="none" id="didresolver-didresolver_rest" style="stroke-width:1.0;"/><!--MD5=[1c316c3243f242c007775beb1eabc8c2]
link didresolver to opdb--><path class="s_181818_e7e7e7" d="M534.193,585.35 C534.379,615.099 534.657,659.655 534.834,687.889 " fill="none" id="didresolver-to-opdb" style="stroke-width:1.0;"/><polygon class="f_181818_e7e7e7 s_181818_e7e7e7" points="534.865,692.963,538.8084,683.938,534.8336,687.9631,530.8085,683.9883,534.865,692.963" style="stroke-width:1.0;"/><text class="f_000000_ffffff" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="105" x="535" y="643.0669">Read operations</text><!--MD5=[393e6ee0d45249774e0399039a877ffd]
link observer_queue to observer--><path class="s_181818_e7e7e7" d="M326,575.09 C326,603.653 326,655.364 326,687.144 " fill="none" id="observer_queue-to-observer" style="stroke-width:1.0;"/><polygon class="f_181818_e7e7e7 s_181818_e7e7e7" points="326,692.451,330,683.451,326,687.451,322,683.451,326,692.451" style="stroke-width:1.0;"/><!--MD5=[6edeb1631270b7ed66066d87e6d8756f]
link observer to cas--><path class="s_181818_e7e7e7" d="M272.659,715.5 C237.458,715.5 192.085,715.5 159.98,715.5 " fill="none" id="observer-to-cas" style="stroke-width:1.0;"/><polygon class="f_181818_e7e7e7 s_181818_e7e7e7" points="154.945,715.5,163.945,719.5,159.945,715.5,163.945,711.5,154.945,715.5" style="stroke-width:1.0;"/><text class="f_000000_ffffff" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="23" x="202.25" y="693.5669">Get</text><text class="f_000000_ffffff" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="82" x="172.75" y="708.6997">AnchorEvent</text><!--MD5=[8de96e168a12e334814c1271ddca9612]
link observer to opdb--><path class="s_181818_e7e7e7" d="M379.01,715.5 C409.762,715.5 448.446,715.5 479.597,715.5 " fill="none" id="observer-to-opdb" style="stroke-width:1.0;"/><polygon class="f_181818_e7e7e7 s_181818_e7e7e7" points="484.924,715.5,475.924,711.5,479.924,715.5,475.924,719.5,484.924,715.5" style="stroke-width:1.0;"/><text class="f_000000_ffffff" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="69" x="397.5" y="693.5669">Read/write</text><text class="f_000000_ffffff" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="68" x="398" y="708.6997">operations</text><!--MD5=[6e9c6b85e98ef86c7c11faf7a91c20a4]
link aphandler to apoutbox--><path class="s_181818_e7e7e7" d="M632.64,260.016 C660.038,300.524 705,367 705,367 C705,367 720.509,462.895 729.225,516.789 " fill="none" id="aphandler-to-apoutbox" style="stroke-width:1.0;"/><polygon class="f_181818_e7e7e7 s_181818_e7e7e7" points="730.046,521.868,732.5572,512.3447,729.2474,516.9322,724.6599,513.6224,730.046,521.868" style="stroke-width:1.0;"/><!--MD5=[125fda4bf10aebad0b74f52c0235d9c8]
link aphandler to observer_queue--><path class="s_181818_e7e7e7" d="M610.003,260.016 C607.351,300.524 603,367 603,367 C603,367 598,492 598,492 C598,492 452.266,524.415 374.145,541.791 " fill="none" id="aphandler-to-observer_queue" style="stroke-width:1.0;"/><polygon class="f_181818_e7e7e7 s_181818_e7e7e7" points="369.099,542.914,378.7529,544.864,373.9797,541.8281,377.0155,537.0549,369.099,542.914" style="stroke-width:1.0;"/><text class="f_000000_ffffff" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="76" x="612" y="395.5669">Post anchor</text><text class="f_000000_ffffff" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="92" x="604" y="410.6997">(from remote)</text><!--MD5=[8dcb029ca168caaa0a238f7ac8c926b2]
reverse link kms to aphandler--><path class="s_181818_e7e7e7" d="M585.728,101.889 C591.305,128.554 599.767,169.009 605.571,196.761 " fill="none" id="kms-backto-aphandler" style="stroke-width:1.0;"/><polygon class="f_181818_e7e7e7 s_181818_e7e7e7" points="584.653,96.748,582.5814,106.3765,585.6772,101.642,590.4118,104.7378,584.653,96.748" style="stroke-width:1.0;"/><text class="f_000000_ffffff" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="64" x="599" y="148.0669">Sign HTTP</text><text class="f_000000_ffffff" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="49" x="606.5" y="163.1997">request</text><!--MD5=[acd00ffce094b6e8a0754649f6ba0ef1]
link aphandler to vct--><path class="s_181818_e7e7e7" d="M578.107,260.104 C561.489,275.11 545,290 545,290 C545,290 522.168,339.089 507.362,370.923 " fill="none" id="aphandler-to-vct" style="stroke-width:1.0;"/><polygon class="f_181818_e7e7e7 s_181818_e7e7e7" points="505.239,375.486,512.6618,369.0128,507.3479,370.9525,505.4082,365.6386,505.239,375.486" style="stroke-width:1.0;"/><text class="f_000000_ffffff" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="47" x="546" y="318.0669">Add VC</text><!--MD5=[07eef0c75077e084592258f96412337c]
link aphandler to anchor_writer--><path class="s_181818_e7e7e7" d="M550.13,255.86 C511.864,272.164 470,290 470,290 C470,290 413.177,332.42 370.921,363.965 " fill="none" id="aphandler-to-anchor_writer" style="stroke-width:1.0;"/><polygon class="f_181818_e7e7e7 s_181818_e7e7e7" points="366.879,366.982,376.4839,364.8034,370.8857,363.9909,371.6982,358.3927,366.879,366.982" style="stroke-width:1.0;"/><text class="f_000000_ffffff" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="44" x="471" y="310.5669">Handle</text><text class="f_000000_ffffff" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="34" x="476" y="325.6997">proof</text><!--MD5=[316727b22bf97f8ac2bff47c9ef5d012]
link anchor_writer to observer_queue--><path class="s_181818_e7e7e7" d="M326,430.094 C326,458.381 326,499.957 326,526.63 " fill="none" id="anchor_writer-to-observer_queue" style="stroke-width:1.0;"/><polygon class="f_181818_e7e7e7 s_181818_e7e7e7" points="326,531.758,330,522.758,326,526.758,322,522.758,326,531.758" style="stroke-width:1.0;"/><text class="f_000000_ffffff" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="76" x="327" y="473.0669">Post anchor</text><text class="f_000000_ffffff" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="74" x="328" y="488.1997">(from local)</text><!--MD5=[dba075fa1a8ee532b66badc5ba3e53ae]
reverse link txndb to anchor_writer--><path class="s_181818_e7e7e7" d="M288.832,264.646 C297.289,294.873 309.365,338.037 317.432,366.874 " fill="none" id="txndb-backto-anchor_writer" style="stroke-width:1.0;"/><polygon class="f_181818_e7e7e7 s_181818_e7e7e7" points="287.403,259.535,285.9762,269.28,288.7504,264.35,293.6803,267.1242,287.403,259.535" style="stroke-width:1.0;"/><text class="f_000000_ffffff" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="82" x="310" y="303.0669">Store anchor</text><text class="f_000000_ffffff" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="53" x="324.5" y="318.1997">hash for</text><text class="f_000000_ffffff" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="58" x="322" y="333.3325">each DID</text><!--MD5=[8a29c2d1181494abb70e4a7a6c998fbd]
reverse link op_queue to opwriter--><path class="s_181818_e7e7e7" d="M242.855,73.5 C273.153,73.5 311.416,73.5 342.482,73.5 " fill="none" id="op_queue-backto-opwriter" style="stroke-width:1.0;"/><polygon class="f_181818_e7e7e7 s_181818_e7e7e7" points="237.679,73.5,246.679,77.5,242.679,73.5,246.679,69.5,237.679,73.5" style="stroke-width:1.0;"/><text class="f_000000_ffffff" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="28" x="276" y="51.5669">Post</text><text class="f_000000_ffffff" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="68" x="256" y="66.6997">operations</text><!--MD5=[084c96b54b7552d7d7d41d6ca05a8dc5]
reverse link batch_writer to op_queue--><path class="s_181818_e7e7e7" d="M114.509,73.5 C122.9,73.5 136.92,73.5 144.354,73.5 " fill="none" id="batch_writer-backto-op_queue" style="stroke-width:1.0;"/><polygon class="f_181818_e7e7e7 s_181818_e7e7e7" points="109.053,73.5,118.053,77.5,114.053,73.5,118.053,69.5,109.053,73.5" style="stroke-width:1.0;"/><!--MD5=[d35399ef57a6f597db49b48809049df7]
link batch_writer to cas--><path class="s_181818_e7e7e7" d="M66,105.094 C66,149.743 66,227.5 66,227.5 C66,227.5 66,227.5 66,554.5 C66,554.5 95.467,641.81 110.866,687.437 " fill="none" id="batch_writer-to-cas" style="stroke-width:1.0;"/><polygon class="f_181818_e7e7e7 s_181818_e7e7e7" points="112.492,692.253,113.4053,682.4466,110.8937,687.5153,105.825,685.0038,112.492,692.253" style="stroke-width:1.0;"/><text class="f_000000_ffffff" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="94" x="67" y="395.5669">Write SideTree</text><text class="f_000000_ffffff" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="66" x="81" y="410.6997">batch files</text><!--MD5=[7e651650182647b406e2b73221fab3b6]
link batch_writer to anchor_writer--><path class="s_181818_e7e7e7" d="M80.6965,105.132 C105.975,157.819 155,260 155,260 C155,260 233.527,323.143 284.152,363.85 " fill="none" id="batch_writer-to-anchor_writer" style="stroke-width:1.0;"/><polygon class="f_181818_e7e7e7 s_181818_e7e7e7" points="288.05,366.984,283.5436,358.2266,284.1538,363.8504,278.5299,364.4606,288.05,366.984" style="stroke-width:1.0;"/><text class="f_000000_ffffff" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="78" x="156" y="233.0669">anchor\DIDs</text><!--MD5=[792a09d04bc966269cb9edc3bcf64202]
link anchor_writer to cas--><path class="s_181818_e7e7e7" d="M289.784,430.096 C246.836,466.38 181,522 181,522 C181,522 145.357,634.48 128.562,687.48 " fill="none" id="anchor_writer-to-cas" style="stroke-width:1.0;"/><polygon class="f_181818_e7e7e7 s_181818_e7e7e7" points="126.997,692.418,133.5286,685.0466,128.5072,687.6515,125.9023,682.6302,126.997,692.418" style="stroke-width:1.0;"/><text class="f_000000_ffffff" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="34" x="206" y="543.0669">Write</text><text class="f_000000_ffffff" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="82" x="182" y="558.1997">AnchorEvent</text><text class="f_000000_ffffff" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="72" x="187" y="573.3325">with proofs</text><!--MD5=[e3d3276a7c9e2517efa0bae0363918cd]
link anchor_writer to vct--><path class="s_181818_e7e7e7" d="M371.734,398.5 C397.835,398.5 430.236,398.5 455.268,398.5 " fill="none" id="anchor_writer-to-vct" style="stroke-width:1.0;"/><polygon class="f_181818_e7e7e7 s_181818_e7e7e7" points="460.493,398.5,451.493,394.5,455.493,398.5,451.493,402.5,460.493,398.5" style="stroke-width:1.0;"/><text class="f_000000_ffffff" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="47" x="392.5" y="391.5669">Add VC</text><!--MD5=[cc01b63cef6fb28a0317e33e0c3b074c]
link anchor_writer to apoutbox--><path class="s_181818_e7e7e7" d="M371.539,416.404 C462.066,450.009 656,522 656,522 C656,522 660.901,523.892 668.262,526.734 " fill="none" id="anchor_writer-to-apoutbox" style="stroke-width:1.0;"/><polygon class="f_181818_e7e7e7 s_181818_e7e7e7" points="673.142,528.618,666.1875,521.6441,668.4778,526.8166,663.3053,529.1069,673.142,528.618" style="stroke-width:1.0;"/><text class="f_000000_ffffff" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="112" x="568" y="473.0669">Post Offer/Create</text><text class="f_000000_ffffff" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="47" x="600.5" y="488.1997">activity</text><!--MD5=[bdcf821bec015dc7a961b0e441927e1f]
link cas to casdb--><path class="s_181818_e7e7e7" d="M128.621,738.602 C135.539,756.34 145.381,781.572 153.366,802.0441 " fill="none" id="cas-to-casdb" style="stroke-width:1.0;stroke-dasharray:7.0,7.0;"/><polygon class="f_181818_e7e7e7 s_181818_e7e7e7" points="155.248,806.8696,155.7032,797.0313,153.4307,802.2116,148.2504,799.939,155.248,806.8696" style="stroke-width:1.0;"/><!--MD5=[b212032fbd47778cc5d8173f95fcad49]
link cas to ipfs--><path class="s_181818_e7e7e7" d="M110.829,738.602 C103.469,756.34 92.999,781.572 84.5045,802.0441 " fill="none" id="cas-to-ipfs" style="stroke-width:1.0;stroke-dasharray:7.0,7.0;"/><polygon class="f_181818_e7e7e7 s_181818_e7e7e7" points="82.5022,806.8696,89.6461,800.0899,84.4185,802.2514,82.257,797.0238,82.5022,806.8696" style="stroke-width:1.0;"/><!--MD5=[8776a176a69fde75f7f58339da0cdace]
link apoutbox to domain2--><path class="s_181818_e7e7e7" d="M796.636,553.5 C831.244,553.5 874.137,553.5 907.967,553.5 " fill="none" id="apoutbox-to-domain2" style="stroke-width:1.0;"/><polygon class="f_181818_e7e7e7 s_181818_e7e7e7" points="913.316,553.5,904.316,549.5,908.316,553.5,904.316,557.5,913.316,553.5" style="stroke-width:1.0;"/><text class="f_000000_ffffff" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="28" x="841" y="516.5669">Post</text><text class="f_000000_ffffff" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="80" x="815" y="531.6997">Offer/Create</text><text class="f_000000_ffffff" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="47" x="831.5" y="546.8325">activity</text><!--MD5=[70b5166131c80c3b239c9291910c62ec]
link apoutbox to domain3--><path class="s_181818_e7e7e7" d="M795.703,585.104 C825.467,600.11 855,615 855,615 C855,615 919.168,659.963 961.233,689.438 " fill="none" id="apoutbox-to-domain3" style="stroke-width:1.0;"/><polygon class="f_181818_e7e7e7 s_181818_e7e7e7" points="965.486,692.418,960.4089,683.9786,961.3906,689.5496,955.8195,690.5313,965.486,692.418" style="stroke-width:1.0;"/><text class="f_000000_ffffff" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="28" x="948" y="628.0669">Post</text><text class="f_000000_ffffff" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="80" x="922" y="643.1997">Offer/Create</text><text class="f_000000_ffffff" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="47" x="938.5" y="658.3325">activity</text><!--MD5=[6bdcfc5f31da711546058ab28a4db3d1]
link domain2 to apinbox--><path class="s_181818_e7e7e7" d="M953.342,530.475 C913.133,454.507 780.011,202.995 730.639,109.715 " fill="none" id="domain2-to-apinbox" style="stroke-width:1.0;"/><polygon class="f_181818_e7e7e7 s_181818_e7e7e7" points="728.211,105.128,728.8857,114.9537,730.5499,109.5472,735.9564,111.2115,728.211,105.128" style="stroke-width:1.0;"/><text class="f_000000_ffffff" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="73" x="851" y="310.5669">Accept/Like</text><text class="f_000000_ffffff" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="47" x="864" y="325.6997">activity</text><!--MD5=[c2b6bbbd1cfeb3fa53848ef5479cef1c]
reverse link apoutbox to domain1admin--><path class="s_181818_e7e7e7" d="M756.426,589.796 C788.94,643.357 847,739 847,739 C847,739 870.374,772.199 889.914,799.95 " fill="none" id="apoutbox-backto-domain1admin" style="stroke-width:1.0;"/><polygon class="f_181818_e7e7e7 s_181818_e7e7e7" points="753.746,585.381,754.9963,595.1502,756.3403,589.6553,761.8352,590.9993,753.746,585.381" style="stroke-width:1.0;"/><text class="f_000000_ffffff" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="28" x="873.5" y="705.0669">Post</text><text class="f_000000_ffffff" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="79" x="848" y="720.1997">Follow/Invite</text><text class="f_000000_ffffff" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="47" x="864" y="735.3325">activity</text><!--MD5=[24e1137c89a5da788346364cae429f1e]
@startuml
'https://plantuml.com/component-diagram

skinparam linetype polyline

frame Domain1 {
  database "CAS\n(local)" as casdb
  database "CAS\n(IPFS)" as ipfs
  database "Operations" as opdb
  database "DID\nTxns" as txndb
  database "Activities" as apdb

  component "ActivityPub\nOutbox" as apoutbox
  component "ActivityPub\nInbox" as apinbox
  component "ActivityPub\nHandler" as aphandler

  interface "HTTPS" as apinbox_rest
  apinbox - apinbox_rest
  apinbox - -> aphandler

  aphandler -left-> apdb : Store activity

  component "Batch\nWriter" as batch_writer
  component "Anchor\nWriter" as anchor_writer
  component "Observer" as observer
  component "CAS" as cas
  component "VCT" as vct

  queue "Observer\nQueue" as observer_queue
  queue "Operation\nQueue" as op_queue

  component "Operation\nWriter" as opwriter

  interface "HTTPS" as opwriter_rest
  opwriter -right- opwriter_rest

  component "DID\nResolver" as didresolver

  interface "HTTPS" as didresolver_rest
  didresolver -right- didresolver_rest

  didresolver - -> opdb : Read operations

  component "KMS" as kms

  observer_queue - -> observer
  observer -> cas : Get\nAnchorEvent
  observer -> opdb : Read/write\noperations

  aphandler - -> apoutbox
  aphandler - -> observer_queue : Post anchor\n(from remote)
  aphandler -up-> kms : Sign HTTP\nrequest
  aphandler -> vct : Add VC
  aphandler - -> anchor_writer : Handle\nproof
  anchor_writer - -> observer_queue : Post anchor\n(from local)
  anchor_writer -up-> txndb : Store anchor\nhash for\neach DID

  opwriter -left-> op_queue : Post\noperations

  op_queue -left-> batch_writer
  batch_writer - -> cas : Write SideTree\nbatch files
  batch_writer - - -> anchor_writer : anchor\DIDs

  anchor_writer -> cas : Write\nAnchorEvent\nwith proofs
  anchor_writer -> vct : Add VC
  anchor_writer - -> apoutbox : Post Offer/Create\nactivity

  cas ..> casdb
  cas ..> ipfs
}

actor "Domain1 Admin" as domain1admin #Azure

frame "Domain2" as domain2 #Azure
frame "Domain3" as domain3 #Azure

apoutbox -> domain2 : Post\nOffer/Create\nactivity
apoutbox - -> domain3 : Post\nOffer/Create\nactivity
domain2 - -> apinbox : Accept/Like\nactivity
domain1admin -up- -> apoutbox : Post\nFollow/Invite\nactivity
@enduml

@startuml

skinparam linetype polyline

frame Domain1 {
  database "CAS\n(local)" as casdb
  database "CAS\n(IPFS)" as ipfs
  database "Operations" as opdb
  database "DID\nTxns" as txndb
  database "Activities" as apdb

  component "ActivityPub\nOutbox" as apoutbox
  component "ActivityPub\nInbox" as apinbox
  component "ActivityPub\nHandler" as aphandler

  interface "HTTPS" as apinbox_rest
  apinbox - apinbox_rest
  apinbox - -> aphandler

  aphandler -left-> apdb : Store activity

  component "Batch\nWriter" as batch_writer
  component "Anchor\nWriter" as anchor_writer
  component "Observer" as observer
  component "CAS" as cas
  component "VCT" as vct

  queue "Observer\nQueue" as observer_queue
  queue "Operation\nQueue" as op_queue

  component "Operation\nWriter" as opwriter

  interface "HTTPS" as opwriter_rest
  opwriter -right- opwriter_rest

  component "DID\nResolver" as didresolver

  interface "HTTPS" as didresolver_rest
  didresolver -right- didresolver_rest

  didresolver - -> opdb : Read operations

  component "KMS" as kms

  observer_queue - -> observer
  observer -> cas : Get\nAnchorEvent
  observer -> opdb : Read/write\noperations

  aphandler - -> apoutbox
  aphandler - -> observer_queue : Post anchor\n(from remote)
  aphandler -up-> kms : Sign HTTP\nrequest
  aphandler -> vct : Add VC
  aphandler - -> anchor_writer : Handle\nproof
  anchor_writer - -> observer_queue : Post anchor\n(from local)
  anchor_writer -up-> txndb : Store anchor\nhash for\neach DID

  opwriter -left-> op_queue : Post\noperations

  op_queue -left-> batch_writer
  batch_writer - -> cas : Write SideTree\nbatch files
  batch_writer - - -> anchor_writer : anchor\DIDs

  anchor_writer -> cas : Write\nAnchorEvent\nwith proofs
  anchor_writer -> vct : Add VC
  anchor_writer - -> apoutbox : Post Offer/Create\nactivity

  cas ..> casdb
  cas ..> ipfs
}

actor "Domain1 Admin" as domain1admin #Azure

frame "Domain2" as domain2 #Azure
frame "Domain3" as domain3 #Azure

apoutbox -> domain2 : Post\nOffer/Create\nactivity
apoutbox - -> domain3 : Post\nOffer/Create\nactivity
domain2 - -> apinbox : Accept/Like\nactivity
domain1admin -up- -> apoutbox : Post\nFollow/Invite\nactivity
@enduml

PlantUML version 1.2022.2beta5(Unknown compile time)
(GPL source distribution)
Java Runtime: Java(TM) SE Runtime Environment
JVM: Java HotSpot(TM) 64-Bit Server VM
Default Encoding: UTF-8
Language: en
Country: US
--></g></svg>