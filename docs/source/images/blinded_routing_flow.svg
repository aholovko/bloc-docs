<?xml version="1.0" encoding="UTF-8" standalone="no"?><svg xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" contentScriptType="application/ecmascript" contentStyleType="text/css" height="2588px" preserveAspectRatio="none" style="width:1577px;height:2588px;" version="1.1" viewBox="0 0 1577 2588" width="1577px" zoomAndPan="magnify"><defs><filter height="300%" id="flnyog7ycoljr" width="300%" x="-1" y="-1"><feGaussianBlur result="blurOut" stdDeviation="2.0"/><feColorMatrix in="blurOut" result="blurOut2" type="matrix" values="0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 .4 0"/><feOffset dx="4.0" dy="4.0" in="blurOut2" result="blurOut3"/><feBlend in="SourceGraphic" in2="blurOut3" mode="normal"/></filter></defs><g><text fill="#000000" font-family="sans-serif" font-size="18" lengthAdjust="spacingAndGlyphs" textLength="412" x="580.5" y="28.708">Blinded routing through User selected route</text><rect fill="#FFFFFF" filter="url(#flnyog7ycoljr)" height="162.7969" style="stroke: #000000; stroke-width: 2.0;" width="455" x="320.5" y="140.25"/><rect fill="#FFFFFF" filter="url(#flnyog7ycoljr)" height="731.8516" style="stroke: #000000; stroke-width: 2.0;" width="1111.5" x="320.5" y="357.8516"/><rect fill="#FFFFFF" filter="url(#flnyog7ycoljr)" height="1194.9766" style="stroke: #000000; stroke-width: 2.0;" width="1553" x="10" y="1144.5078"/><rect fill="#FFFFFF" filter="url(#flnyog7ycoljr)" height="133.6641" style="stroke: #000000; stroke-width: 2.0;" width="1188.5" x="10" y="2353.4844"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="69" x2="69" y1="123.25" y2="310.0469"/><line style="stroke: #A80036; stroke-width: 1.0; stroke-dasharray: 1.0,4.0;" x1="69" x2="69" y1="310.0469" y2="350.8516"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="69" x2="69" y1="350.8516" y2="1096.7031"/><line style="stroke: #A80036; stroke-width: 1.0; stroke-dasharray: 1.0,4.0;" x1="69" x2="69" y1="1096.7031" y2="1137.5078"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="69" x2="69" y1="1137.5078" y2="2504.1484"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="354.5" x2="354.5" y1="123.25" y2="310.0469"/><line style="stroke: #A80036; stroke-width: 1.0; stroke-dasharray: 1.0,4.0;" x1="354.5" x2="354.5" y1="310.0469" y2="350.8516"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="354.5" x2="354.5" y1="350.8516" y2="1096.7031"/><line style="stroke: #A80036; stroke-width: 1.0; stroke-dasharray: 1.0,4.0;" x1="354.5" x2="354.5" y1="1096.7031" y2="1137.5078"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="354.5" x2="354.5" y1="1137.5078" y2="2504.1484"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="733.5" x2="733.5" y1="123.25" y2="310.0469"/><line style="stroke: #A80036; stroke-width: 1.0; stroke-dasharray: 1.0,4.0;" x1="733.5" x2="733.5" y1="310.0469" y2="350.8516"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="733.5" x2="733.5" y1="350.8516" y2="1096.7031"/><line style="stroke: #A80036; stroke-width: 1.0; stroke-dasharray: 1.0,4.0;" x1="733.5" x2="733.5" y1="1096.7031" y2="1137.5078"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="733.5" x2="733.5" y1="1137.5078" y2="2504.1484"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="1126.5" x2="1126.5" y1="123.25" y2="310.0469"/><line style="stroke: #A80036; stroke-width: 1.0; stroke-dasharray: 1.0,4.0;" x1="1126.5" x2="1126.5" y1="310.0469" y2="350.8516"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="1126.5" x2="1126.5" y1="350.8516" y2="1096.7031"/><line style="stroke: #A80036; stroke-width: 1.0; stroke-dasharray: 1.0,4.0;" x1="1126.5" x2="1126.5" y1="1096.7031" y2="1137.5078"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="1126.5" x2="1126.5" y1="1137.5078" y2="2504.1484"/><rect fill="#FEFECE" filter="url(#flnyog7ycoljr)" height="30.2969" style="stroke: #A80036; stroke-width: 1.5;" width="94" x="20" y="87.9531"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacingAndGlyphs" textLength="80" x="27" y="107.9482">rp_adapter</text><rect fill="#FEFECE" filter="url(#flnyog7ycoljr)" height="30.2969" style="stroke: #A80036; stroke-width: 1.5;" width="94" x="20" y="2503.1484"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacingAndGlyphs" textLength="80" x="27" y="2523.1436">rp_adapter</text><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacingAndGlyphs" textLength="43" x="330.5" y="119.9482">wallet</text><ellipse cx="355" cy="49.9531" fill="#FEFECE" filter="url(#flnyog7ycoljr)" rx="8" ry="8" style="stroke: #A80036; stroke-width: 2.0;"/><path d="M355,57.9531 L355,84.9531 M342,65.9531 L368,65.9531 M355,84.9531 L342,99.9531 M355,84.9531 L368,99.9531 " fill="none" filter="url(#flnyog7ycoljr)" style="stroke: #A80036; stroke-width: 2.0;"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacingAndGlyphs" textLength="43" x="330.5" y="2516.1436">wallet</text><ellipse cx="355" cy="2529.4453" fill="#FEFECE" filter="url(#flnyog7ycoljr)" rx="8" ry="8" style="stroke: #A80036; stroke-width: 2.0;"/><path d="M355,2537.4453 L355,2564.4453 M342,2545.4453 L368,2545.4453 M355,2564.4453 L342,2579.4453 M355,2564.4453 L368,2579.4453 " fill="none" filter="url(#flnyog7ycoljr)" style="stroke: #A80036; stroke-width: 2.0;"/><rect fill="#FEFECE" filter="url(#flnyog7ycoljr)" height="30.2969" style="stroke: #A80036; stroke-width: 1.5;" width="59" x="702.5" y="87.9531"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacingAndGlyphs" textLength="45" x="709.5" y="107.9482">router</text><rect fill="#FEFECE" filter="url(#flnyog7ycoljr)" height="30.2969" style="stroke: #A80036; stroke-width: 1.5;" width="59" x="702.5" y="2503.1484"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacingAndGlyphs" textLength="45" x="709.5" y="2523.1436">router</text><rect fill="#FEFECE" filter="url(#flnyog7ycoljr)" height="30.2969" style="stroke: #A80036; stroke-width: 1.5;" width="119" x="1065.5" y="87.9531"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacingAndGlyphs" textLength="105" x="1072.5" y="107.9482">issuer_adapter</text><rect fill="#FEFECE" filter="url(#flnyog7ycoljr)" height="30.2969" style="stroke: #A80036; stroke-width: 1.5;" width="119" x="1065.5" y="2503.1484"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacingAndGlyphs" textLength="105" x="1072.5" y="2523.1436">issuer_adapter</text><path d="M320.5,140.25 L503.5,140.25 L503.5,147.25 L493.5,157.25 L320.5,157.25 L320.5,140.25 " fill="#EEEEEE" style="stroke: #000000; stroke-width: 1.0;"/><rect fill="none" height="162.7969" style="stroke: #000000; stroke-width: 2.0;" width="455" x="320.5" y="140.25"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="138" x="335.5" y="153.3169">Wallet onboarding</text><polygon fill="#A80036" points="722,174.5156,732,178.5156,722,182.5156,726,178.5156" style="stroke: #A80036; stroke-width: 1.0;"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="355" x2="728" y1="178.5156" y2="178.5156"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="268" x="362" y="173.4497">HTTP POST Generate DIDComm invitation</text><polygon fill="#A80036" points="366,203.6484,356,207.6484,366,211.6484,362,207.6484" style="stroke: #A80036; stroke-width: 1.0;"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="360" x2="733" y1="207.6484" y2="207.6484"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="124" x="372" y="202.5825">HTTP 200 Invitation</text><polygon fill="#A80036" points="366,232.7813,356,236.7813,366,240.7813,362,236.7813" style="stroke: #A80036; stroke-width: 1.0;"/><polygon fill="#A80036" points="722,232.7813,732,236.7813,722,240.7813,726,236.7813" style="stroke: #A80036; stroke-width: 1.0;"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="360" x2="728" y1="236.7813" y2="236.7813"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="166" x="372" y="231.7153">DIDComm (DIDExchange)</text><polygon fill="#A80036" points="722,261.9141,732,265.9141,722,269.9141,726,265.9141" style="stroke: #A80036; stroke-width: 1.0;"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="355" x2="728" y1="265.9141" y2="265.9141"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="167" x="362" y="260.8481">DIDComm (register route)</text><polygon fill="#A80036" points="366,291.0469,356,295.0469,366,299.0469,362,295.0469" style="stroke: #A80036; stroke-width: 1.0;"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="360" x2="733" y1="295.0469" y2="295.0469"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="184" x="372" y="289.981">DIDComm (register success)</text><text fill="#000000" font-family="sans-serif" font-size="11" lengthAdjust="spacingAndGlyphs" textLength="252" x="472" y="334.2573">when user wants to connect issuer to wallet</text><path d="M320.5,357.8516 L533.5,357.8516 L533.5,364.8516 L523.5,374.8516 L320.5,374.8516 L320.5,357.8516 " fill="#EEEEEE" style="stroke: #000000; stroke-width: 1.0;"/><rect fill="none" height="731.8516" style="stroke: #000000; stroke-width: 2.0;" width="1111.5" x="320.5" y="357.8516"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="168" x="335.5" y="370.9185">Issuer-Wallet Connect</text><polygon fill="#A80036" points="366,407.25,356,411.25,366,415.25,362,411.25" style="stroke: #A80036; stroke-width: 1.0;"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="360" x2="1126" y1="411.25" y2="411.25"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="95" x="372" y="391.0513">CHAPI Request</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="257" x="372" y="406.1841">(DIDComm invitation + Governance VC)</text><polygon fill="#A80036" points="1115,436.3828,1125,440.3828,1115,444.3828,1119,440.3828" style="stroke: #A80036; stroke-width: 1.0;"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="355" x2="1121" y1="440.3828" y2="440.3828"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="170" x="362" y="435.3169">DIDComm (DID Exchange)</text><polygon fill="#A80036" points="745,465.5156,735,469.5156,745,473.5156,741,469.5156" style="stroke: #A80036; stroke-width: 1.0;"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="739" x2="1126" y1="469.5156" y2="469.5156"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="226" x="751" y="464.4497">DIDComm Forward (DID Exchange)</text><polygon fill="#A80036" points="366,494.6484,356,498.6484,366,502.6484,362,498.6484" style="stroke: #A80036; stroke-width: 1.0;"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="360" x2="733" y1="498.6484" y2="498.6484"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="170" x="372" y="493.5825">DIDComm (DID Exchange)</text><polygon fill="#A80036" points="1115,538.9141,1125,542.9141,1115,546.9141,1119,542.9141" style="stroke: #A80036; stroke-width: 1.0;"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="355" x2="1121" y1="542.9141" y2="542.9141"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="258" x="362" y="522.7153">DIDComm (RFC0351-PurposeDecorator)</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="174" x="362" y="537.8481">Request PeerDID for router</text><line style="stroke: #A80036; stroke-width: 1.0;" x1="1127" x2="1169" y1="572.0469" y2="572.0469"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="1169" x2="1169" y1="572.0469" y2="585.0469"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="1128" x2="1169" y1="585.0469" y2="585.0469"/><polygon fill="#A80036" points="1138,581.0469,1128,585.0469,1138,589.0469,1134,585.0469" style="stroke: #A80036; stroke-width: 1.0;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="128" x="1134" y="566.981">create new PeerDID</text><polygon fill="#A80036" points="745,625.3125,735,629.3125,745,633.3125,741,629.3125" style="stroke: #A80036; stroke-width: 1.0;"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="739" x2="1126" y1="629.3125" y2="629.3125"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="314" x="751" y="609.1138">DIDComm Forward (RFC0351-PurposeDecorator)</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="159" x="751" y="624.2466">Issuer PeerDID for router</text><polygon fill="#A80036" points="366,669.5781,356,673.5781,366,677.5781,362,673.5781" style="stroke: #A80036; stroke-width: 1.0;"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="360" x2="733" y1="673.5781" y2="673.5781"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="258" x="372" y="653.3794">DIDComm (RFC0351-PurposeDecorator)</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="159" x="372" y="668.5122">Issuer PeerDID for router</text><polygon fill="#A80036" points="722,713.8438,732,717.8438,722,721.8438,726,717.8438" style="stroke: #A80036; stroke-width: 1.0;"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="355" x2="728" y1="717.8438" y2="717.8438"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="258" x="362" y="697.645">DIDComm (RFC0351-PurposeDecorator)</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="355" x="362" y="712.7778">Request PeerDID for issuer (pass issuer peerDID in req)</text><line style="stroke: #A80036; stroke-width: 1.0;" x1="734" x2="776" y1="762.1094" y2="762.1094"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="776" x2="776" y1="762.1094" y2="775.1094"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="735" x2="776" y1="775.1094" y2="775.1094"/><polygon fill="#A80036" points="745,771.1094,735,775.1094,745,779.1094,741,775.1094" style="stroke: #A80036; stroke-width: 1.0;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="142" x="741" y="741.9106">create new PeerDID +</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="240" x="741" y="757.0435">manual connection record with issuer</text><polygon fill="#A80036" points="366,815.375,356,819.375,366,823.375,362,819.375" style="stroke: #A80036; stroke-width: 1.0;"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="360" x2="733" y1="819.375" y2="819.375"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="258" x="372" y="799.1763">DIDComm (RFC0351-PurposeDecorator)</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="163" x="372" y="814.3091">Router PeerDID for issuer</text><polygon fill="#A80036" points="1115,859.6406,1125,863.6406,1115,867.6406,1119,863.6406" style="stroke: #A80036; stroke-width: 1.0;"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="355" x2="1121" y1="863.6406" y2="863.6406"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="258" x="362" y="843.4419">DIDComm (RFC0351-PurposeDecorator)</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="135" x="362" y="858.5747">Send Router PeerDID</text><line style="stroke: #A80036; stroke-width: 1.0;" x1="1127" x2="1169" y1="892.7734" y2="892.7734"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="1169" x2="1169" y1="892.7734" y2="905.7734"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="1128" x2="1169" y1="905.7734" y2="905.7734"/><polygon fill="#A80036" points="1138,901.7734,1128,905.7734,1138,909.7734,1134,905.7734" style="stroke: #A80036; stroke-width: 1.0;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="286" x="1134" y="887.7075">create manual connection record with router</text><polygon fill="#A80036" points="745,930.9063,735,934.9063,745,938.9063,741,934.9063" style="stroke: #A80036; stroke-width: 1.0;"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="739" x2="1126" y1="934.9063" y2="934.9063"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="167" x="751" y="929.8403">DIDComm (register route)</text><polygon fill="#A80036" points="1115,960.0391,1125,964.0391,1115,968.0391,1119,964.0391" style="stroke: #A80036; stroke-width: 1.0;"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="734" x2="1121" y1="964.0391" y2="964.0391"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="184" x="741" y="958.9731">DIDComm (register success)</text><polygon fill="#A80036" points="745,1004.3047,735,1008.3047,745,1012.3047,741,1008.3047" style="stroke: #A80036; stroke-width: 1.0;"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="739" x2="1126" y1="1008.3047" y2="1008.3047"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="314" x="751" y="988.106">DIDComm Forward (RFC0351-PurposeDecorator)</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="115" x="751" y="1003.2388">Success message</text><polygon fill="#A80036" points="366,1048.5703,356,1052.5703,366,1056.5703,362,1052.5703" style="stroke: #A80036; stroke-width: 1.0;"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="360" x2="733" y1="1052.5703" y2="1052.5703"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="258" x="372" y="1032.3716">DIDComm (RFC0351-PurposeDecorator)</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="115" x="372" y="1047.5044">Success message</text><polygon fill="#A80036" points="1115,1077.7031,1125,1081.7031,1115,1085.7031,1119,1081.7031" style="stroke: #A80036; stroke-width: 1.0;"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="355" x2="1121" y1="1081.7031" y2="1081.7031"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="101" x="362" y="1076.6372">CHAPI response</text><text fill="#000000" font-family="sans-serif" font-size="11" lengthAdjust="spacingAndGlyphs" textLength="212" x="494" y="1120.9136">when rp wants credential from wallet</text><path d="M10,1144.5078 L449,1144.5078 L449,1151.5078 L439,1161.5078 L10,1161.5078 L10,1144.5078 " fill="#EEEEEE" style="stroke: #000000; stroke-width: 1.0;"/><rect fill="none" height="1194.9766" style="stroke: #000000; stroke-width: 2.0;" width="1553" x="10" y="1144.5078"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="394" x="25" y="1157.5747">RP-Wallet Connect and Wallet-Issuer AuthZ request</text><polygon fill="#A80036" points="343,1193.9063,353,1197.9063,343,1201.9063,347,1197.9063" style="stroke: #A80036; stroke-width: 1.0;"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="69" x2="349" y1="1197.9063" y2="1197.9063"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="95" x="76" y="1177.7075">CHAPI Request</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="257" x="76" y="1192.8403">(DIDComm invitation + Governance VC)</text><polygon fill="#A80036" points="80,1223.0391,70,1227.0391,80,1231.0391,76,1227.0391" style="stroke: #A80036; stroke-width: 1.0;"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="74" x2="354" y1="1227.0391" y2="1227.0391"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="170" x="86" y="1221.9731">DIDComm (DID Exchange)</text><polygon fill="#A80036" points="722,1252.1719,732,1256.1719,722,1260.1719,726,1256.1719" style="stroke: #A80036; stroke-width: 1.0;"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="69" x2="728" y1="1256.1719" y2="1256.1719"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="222" x="76" y="1251.106">DIDComm Forward(DID Exchange)</text><polygon fill="#A80036" points="366,1281.3047,356,1285.3047,366,1289.3047,362,1285.3047" style="stroke: #A80036; stroke-width: 1.0;"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="360" x2="733" y1="1285.3047" y2="1285.3047"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="170" x="372" y="1280.2388">DIDComm (DID Exchange)</text><polygon fill="#A80036" points="80,1325.5703,70,1329.5703,80,1333.5703,76,1329.5703" style="stroke: #A80036; stroke-width: 1.0;"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="74" x2="354" y1="1329.5703" y2="1329.5703"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="258" x="86" y="1309.3716">DIDComm (RFC0351-PurposeDecorator)</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="174" x="86" y="1324.5044">Request PeerDID for router</text><line style="stroke: #A80036; stroke-width: 1.0;" x1="69" x2="111" y1="1358.7031" y2="1358.7031"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="111" x2="111" y1="1358.7031" y2="1371.7031"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="70" x2="111" y1="1371.7031" y2="1371.7031"/><polygon fill="#A80036" points="80,1367.7031,70,1371.7031,80,1375.7031,76,1371.7031" style="stroke: #A80036; stroke-width: 1.0;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="128" x="76" y="1353.6372">create new PeerDID</text><polygon fill="#A80036" points="722,1411.9688,732,1415.9688,722,1419.9688,726,1415.9688" style="stroke: #A80036; stroke-width: 1.0;"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="69" x2="728" y1="1415.9688" y2="1415.9688"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="310" x="76" y="1395.77">DIDComm Forward(RFC0351-PurposeDecorator)</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="138" x="76" y="1410.9028">RP PeerDID for router</text><polygon fill="#A80036" points="366,1456.2344,356,1460.2344,366,1464.2344,362,1460.2344" style="stroke: #A80036; stroke-width: 1.0;"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="360" x2="733" y1="1460.2344" y2="1460.2344"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="258" x="372" y="1440.0356">DIDComm (RFC0351-PurposeDecorator)</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="138" x="372" y="1455.1685">RP PeerDID for router</text><polygon fill="#A80036" points="722,1500.5,732,1504.5,722,1508.5,726,1504.5" style="stroke: #A80036; stroke-width: 1.0;"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="355" x2="728" y1="1504.5" y2="1504.5"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="258" x="362" y="1484.3013">DIDComm (RFC0351-PurposeDecorator)</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="313" x="362" y="1499.4341">Request PeerDID for RP (pass RP peerDID in req)</text><line style="stroke: #A80036; stroke-width: 1.0;" x1="734" x2="776" y1="1533.6328" y2="1533.6328"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="776" x2="776" y1="1533.6328" y2="1546.6328"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="735" x2="776" y1="1546.6328" y2="1546.6328"/><polygon fill="#A80036" points="745,1542.6328,735,1546.6328,745,1550.6328,741,1546.6328" style="stroke: #A80036; stroke-width: 1.0;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="379" x="741" y="1528.5669">create new PeerDID and manual connection record with RP</text><polygon fill="#A80036" points="366,1586.8984,356,1590.8984,366,1594.8984,362,1590.8984" style="stroke: #A80036; stroke-width: 1.0;"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="360" x2="733" y1="1590.8984" y2="1590.8984"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="258" x="372" y="1570.6997">DIDComm (RFC0351-PurposeDecorator)</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="142" x="372" y="1585.8325">Router PeerDID for RP</text><polygon fill="#A80036" points="80,1631.1641,70,1635.1641,80,1639.1641,76,1635.1641" style="stroke: #A80036; stroke-width: 1.0;"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="74" x2="354" y1="1635.1641" y2="1635.1641"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="258" x="86" y="1614.9653">DIDComm (RFC0351-PurposeDecorator)</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="135" x="86" y="1630.0981">Send Router PeerDID</text><polygon fill="#A80036" points="722,1660.2969,732,1664.2969,722,1668.2969,726,1664.2969" style="stroke: #A80036; stroke-width: 1.0;"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="69" x2="728" y1="1664.2969" y2="1664.2969"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="167" x="76" y="1659.231">DIDComm (register route)</text><polygon fill="#A80036" points="80,1689.4297,70,1693.4297,80,1697.4297,76,1693.4297" style="stroke: #A80036; stroke-width: 1.0;"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="74" x2="733" y1="1693.4297" y2="1693.4297"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="184" x="86" y="1688.3638">DIDComm (register success)</text><polygon fill="#A80036" points="722,1733.6953,732,1737.6953,722,1741.6953,726,1737.6953" style="stroke: #A80036; stroke-width: 1.0;"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="69" x2="728" y1="1737.6953" y2="1737.6953"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="314" x="76" y="1717.4966">DIDComm Forward (RFC0351-PurposeDecorator)</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="115" x="76" y="1732.6294">Success message</text><polygon fill="#A80036" points="366,1777.9609,356,1781.9609,366,1785.9609,362,1781.9609" style="stroke: #A80036; stroke-width: 1.0;"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="360" x2="733" y1="1781.9609" y2="1781.9609"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="258" x="372" y="1761.7622">DIDComm (RFC0351-PurposeDecorator)</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="115" x="372" y="1776.895">Success message</text><polygon fill="#A80036" points="80,1822.2266,70,1826.2266,80,1830.2266,76,1826.2266" style="stroke: #A80036; stroke-width: 1.0;"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="74" x2="354" y1="1826.2266" y2="1826.2266"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="258" x="86" y="1806.0278">DIDComm (RFC0351-PurposeDecorator)</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="175" x="86" y="1821.1606">Request PeerDID for AuthZ</text><line style="stroke: #A80036; stroke-width: 1.0;" x1="69" x2="111" y1="1855.3594" y2="1855.3594"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="111" x2="111" y1="1855.3594" y2="1868.3594"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="70" x2="111" y1="1868.3594" y2="1868.3594"/><polygon fill="#A80036" points="80,1864.3594,70,1868.3594,80,1872.3594,76,1868.3594" style="stroke: #A80036; stroke-width: 1.0;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="237" x="76" y="1850.2935">Create Peer DID with router endpoint</text><polygon fill="#A80036" points="722,1893.4922,732,1897.4922,722,1901.4922,726,1897.4922" style="stroke: #A80036; stroke-width: 1.0;"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="69" x2="728" y1="1897.4922" y2="1897.4922"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="237" x="76" y="1892.4263">DIDComm (register peerDID pubKey)</text><polygon fill="#A80036" points="80,1922.625,70,1926.625,80,1930.625,76,1926.625" style="stroke: #A80036; stroke-width: 1.0;"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="74" x2="733" y1="1926.625" y2="1926.625"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="211" x="86" y="1921.5591">DIDComm (register key success)</text><polygon fill="#A80036" points="722,1966.8906,732,1970.8906,722,1974.8906,726,1970.8906" style="stroke: #A80036; stroke-width: 1.0;"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="69" x2="728" y1="1970.8906" y2="1970.8906"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="310" x="76" y="1950.6919">DIDComm Forward(RFC0351-PurposeDecorator)</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="139" x="76" y="1965.8247">RP PeerDID for AuthZ</text><polygon fill="#A80036" points="366,2011.1563,356,2015.1563,366,2019.1563,362,2015.1563" style="stroke: #A80036; stroke-width: 1.0;"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="360" x2="733" y1="2015.1563" y2="2015.1563"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="310" x="372" y="1994.9575">DIDComm Forward(RFC0351-PurposeDecorator)</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="139" x="372" y="2010.0903">RP PeerDID for AuthZ</text><line style="stroke: #A80036; stroke-width: 1.0;" x1="355" x2="397" y1="2044.2891" y2="2044.2891"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="397" x2="397" y1="2044.2891" y2="2057.2891"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="356" x2="397" y1="2057.2891" y2="2057.2891"/><polygon fill="#A80036" points="366,2053.2891,356,2057.2891,366,2061.2891,362,2057.2891" style="stroke: #A80036; stroke-width: 1.0;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="236" x="362" y="2039.2231">Create Peer DID for AuthZ credential</text><polygon fill="#A80036" points="1115,2097.5547,1125,2101.5547,1115,2105.5547,1119,2101.5547" style="stroke: #A80036; stroke-width: 1.0;"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="355" x2="1121" y1="2101.5547" y2="2101.5547"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="66" x="362" y="2081.356">DIDComm</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="265" x="362" y="2096.4888">(authz request- walletDIDDoc+rpDIDDoc)</text><line style="stroke: #A80036; stroke-width: 1.0;" x1="1127" x2="1169" y1="2130.6875" y2="2130.6875"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="1169" x2="1169" y1="2130.6875" y2="2143.6875"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="1128" x2="1169" y1="2143.6875" y2="2143.6875"/><polygon fill="#A80036" points="1138,2139.6875,1128,2143.6875,1138,2147.6875,1134,2143.6875" style="stroke: #A80036; stroke-width: 1.0;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="237" x="1134" y="2125.6216">Create Peer DID with router endpoint</text><polygon fill="#A80036" points="745,2168.8203,735,2172.8203,745,2176.8203,741,2172.8203" style="stroke: #A80036; stroke-width: 1.0;"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="739" x2="1126" y1="2172.8203" y2="2172.8203"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="237" x="751" y="2167.7544">DIDComm (register peerDID pubKey)</text><polygon fill="#A80036" points="1115,2197.9531,1125,2201.9531,1115,2205.9531,1119,2201.9531" style="stroke: #A80036; stroke-width: 1.0;"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="734" x2="1121" y1="2201.9531" y2="2201.9531"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="211" x="741" y="2196.8872">DIDComm (register key success)</text><line style="stroke: #A80036; stroke-width: 1.0;" x1="1127" x2="1169" y1="2231.0859" y2="2231.0859"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="1169" x2="1169" y1="2231.0859" y2="2244.0859"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="1128" x2="1169" y1="2244.0859" y2="2244.0859"/><polygon fill="#A80036" points="1138,2240.0859,1128,2244.0859,1138,2248.0859,1134,2244.0859" style="stroke: #A80036; stroke-width: 1.0;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="417" x="1134" y="2226.02">Create AuthZ response (walletDIDDoc+rpDIDDoc+issuerDIDDoc)</text><polygon fill="#A80036" points="745,2269.2188,735,2273.2188,745,2277.2188,741,2273.2188" style="stroke: #A80036; stroke-width: 1.0;"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="739" x2="1126" y1="2273.2188" y2="2273.2188"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="231" x="751" y="2268.1528">DIDComm Forward(authz response)</text><polygon fill="#A80036" points="366,2298.3516,356,2302.3516,366,2306.3516,362,2302.3516" style="stroke: #A80036; stroke-width: 1.0;"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="360" x2="733" y1="2302.3516" y2="2302.3516"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="175" x="372" y="2297.2856">DIDComm(authz response)</text><polygon fill="#A80036" points="80,2327.4844,70,2331.4844,80,2335.4844,76,2331.4844" style="stroke: #A80036; stroke-width: 1.0;"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="74" x2="354" y1="2331.4844" y2="2331.4844"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="101" x="86" y="2326.4185">CHAPI response</text><path d="M10,2353.4844 L369,2353.4844 L369,2360.4844 L359,2370.4844 L10,2370.4844 L10,2353.4844 " fill="#EEEEEE" style="stroke: #000000; stroke-width: 1.0;"/><rect fill="none" height="133.6641" style="stroke: #000000; stroke-width: 2.0;" width="1188.5" x="10" y="2353.4844"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="314" x="25" y="2366.5513">RP asks for actual credential from issuer</text><polygon fill="#A80036" points="722,2387.75,732,2391.75,722,2395.75,726,2391.75" style="stroke: #A80036; stroke-width: 1.0;"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="69" x2="728" y1="2391.75" y2="2391.75"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="223" x="76" y="2386.6841">DIDComm Forward (Actual VC req)</text><polygon fill="#A80036" points="1115,2416.8828,1125,2420.8828,1115,2424.8828,1119,2420.8828" style="stroke: #A80036; stroke-width: 1.0;"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="734" x2="1121" y1="2420.8828" y2="2420.8828"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="167" x="741" y="2415.8169">DIDComm (Actual VC req)</text><polygon fill="#A80036" points="745,2446.0156,735,2450.0156,745,2454.0156,741,2450.0156" style="stroke: #A80036; stroke-width: 1.0;"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="739" x2="1126" y1="2450.0156" y2="2450.0156"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="186" x="751" y="2444.9497">DIDComm Forward (VC resp)</text><polygon fill="#A80036" points="80,2475.1484,70,2479.1484,80,2483.1484,76,2479.1484" style="stroke: #A80036; stroke-width: 1.0;"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="74" x2="733" y1="2479.1484" y2="2479.1484"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="130" x="86" y="2474.0825">DIDComm (VC resp)</text><!--MD5=[68a1ee8edec724bef7c44325f8bdb270]
@startuml
title Blinded routing through User selected route

participant rp_adapter as ra
actor wallet
participant router
participant issuer_adapter as ia

group Wallet onboarding
wallet -> router : HTTP POST Generate DIDComm invitation
router -> wallet : HTTP 200 Invitation
wallet <-> router : DIDComm (DIDExchange)
wallet -> router : DIDComm (register route)
router -> wallet : DIDComm (register success)
end

... when user wants to connect issuer to wallet ...
group Issuer-Wallet Connect
ia -> wallet : CHAPI Request\n(DIDComm invitation + Governance VC)
wallet -> ia : DIDComm (DID Exchange)
ia -> router : DIDComm Forward (DID Exchange)
router -> wallet : DIDComm (DID Exchange)

wallet -> ia : DIDComm (RFC0351-PurposeDecorator) \nRequest PeerDID for router
ia -> ia : create new PeerDID
ia -> router : DIDComm Forward (RFC0351-PurposeDecorator) \nIssuer PeerDID for router
router -> wallet : DIDComm (RFC0351-PurposeDecorator) \nIssuer PeerDID for router
wallet -> router : DIDComm (RFC0351-PurposeDecorator) \nRequest PeerDID for issuer (pass issuer peerDID in req)
router -> router : create new PeerDID + \nmanual connection record with issuer
router -> wallet : DIDComm (RFC0351-PurposeDecorator) \nRouter PeerDID for issuer
wallet -> ia : DIDComm (RFC0351-PurposeDecorator) \nSend Router PeerDID
ia -> ia : create manual connection record with router
ia -> router : DIDComm (register route)
router -> ia : DIDComm (register success)
ia -> router : DIDComm Forward (RFC0351-PurposeDecorator) \nSuccess message
router -> wallet : DIDComm (RFC0351-PurposeDecorator) \nSuccess message
wallet -> ia : CHAPI response
end

... when rp wants credential from wallet...
group RP-Wallet Connect and Wallet-Issuer AuthZ request
ra -> wallet : CHAPI Request\n(DIDComm invitation + Governance VC)
wallet -> ra : DIDComm (DID Exchange)
ra -> router : DIDComm Forward(DID Exchange)
router -> wallet : DIDComm (DID Exchange)

wallet -> ra : DIDComm (RFC0351-PurposeDecorator) \nRequest PeerDID for router
ra -> ra : create new PeerDID
ra -> router : DIDComm Forward(RFC0351-PurposeDecorator) \nRP PeerDID for router
router -> wallet : DIDComm (RFC0351-PurposeDecorator) \nRP PeerDID for router
wallet -> router : DIDComm (RFC0351-PurposeDecorator) \nRequest PeerDID for RP (pass RP peerDID in req)
router -> router : create new PeerDID and manual connection record with RP
router -> wallet : DIDComm (RFC0351-PurposeDecorator) \nRouter PeerDID for RP
wallet -> ra : DIDComm (RFC0351-PurposeDecorator) \nSend Router PeerDID
ra -> router : DIDComm (register route)
router -> ra : DIDComm (register success)

ra -> router : DIDComm Forward (RFC0351-PurposeDecorator) \nSuccess message
router -> wallet : DIDComm (RFC0351-PurposeDecorator) \nSuccess message
wallet -> ra : DIDComm (RFC0351-PurposeDecorator) \nRequest PeerDID for AuthZ
ra -> ra : Create Peer DID with router endpoint
ra -> router : DIDComm (register peerDID pubKey)
router -> ra : DIDComm (register key success)
ra -> router : DIDComm Forward(RFC0351-PurposeDecorator) \nRP PeerDID for AuthZ
router -> wallet : DIDComm Forward(RFC0351-PurposeDecorator) \nRP PeerDID for AuthZ
wallet -> wallet : Create Peer DID for AuthZ credential
wallet -> ia : DIDComm \n(authz request- walletDIDDoc+rpDIDDoc)
ia -> ia : Create Peer DID with router endpoint
ia -> router : DIDComm (register peerDID pubKey)
router -> ia : DIDComm (register key success)
ia -> ia : Create AuthZ response (walletDIDDoc+rpDIDDoc+issuerDIDDoc)
ia -> router : DIDComm Forward(authz response)
router -> wallet : DIDComm(authz response)
wallet -> ra : CHAPI response
end

group RP asks for actual credential from issuer
ra -> router : DIDComm Forward (Actual VC req)
router -> ia : DIDComm (Actual VC req)
ia -> router : DIDComm Forward (VC resp)
router -> ra : DIDComm (VC resp)
end
@enduml

PlantUML version 1.2020.20beta13(Unknown compile time)
(GPL source distribution)
Java Runtime: Java(TM) SE Runtime Environment
JVM: Java HotSpot(TM) 64-Bit Server VM
Default Encoding: UTF-8
Language: en
Country: US
--></g></svg>