<?xml version="1.0" encoding="UTF-8" standalone="no"?><svg xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" contentStyleType="text/css" height="877px" preserveAspectRatio="none" style="width:494px;height:877px;" version="1.1" viewBox="0 0 494 877" width="494px" zoomAndPan="magnify"><defs><style type="text/css"><![CDATA[*.f_ffffff_000000 {fill:#ffffff;}*.s_181818_e7e7e7 {stroke:#181818;}*.s_000000_ffffff {stroke:#000000;}*.f_000000_ffffff {fill:#000000;}*.f_181818_e7e7e7 {fill:#181818;}*.f_eeeeee_555555 {fill:#eeeeee;}@media (prefers-color-scheme:dark) {*.f_ffffff_000000 {fill:#000000;}*.s_181818_e7e7e7 {stroke:#e7e7e7;}*.s_000000_ffffff {stroke:#ffffff;}*.f_000000_ffffff {fill:#ffffff;}*.f_181818_e7e7e7 {fill:#e7e7e7;}*.f_eeeeee_555555 {fill:#555555;}}]]></style></defs><g><rect class="f_ffffff_000000 s_181818_e7e7e7" height="570.3984" style="stroke-width:1.0;" width="10" x="129" y="112.4297"/><rect class="f_ffffff_000000 s_181818_e7e7e7" height="59.3984" style="stroke-width:1.0;" width="10" x="129" y="711.9609"/><rect class="f_ffffff_000000 s_181818_e7e7e7" height="398.4688" style="stroke-width:1.0;" width="10" x="424.5" y="388.8906"/><rect class="s_000000_ffffff" height="593.6641" style="stroke-width:1.5;fill:none;" width="478" x="10" y="185.6953"/><rect class="s_000000_ffffff" height="387.6016" style="stroke-width:1.5;fill:none;" width="420" x="58" y="267.0938"/><rect class="s_000000_ffffff" height="164.7344" style="stroke-width:1.5;fill:none;" width="400" x="68" y="291.2266"/><rect class="s_000000_ffffff" height="120.7969" style="stroke-width:1.5;fill:none;" width="400" x="68" y="526.8984"/><line class="s_181818_e7e7e7" style="stroke-width:0.5;fill:none;stroke-dasharray:5.0,5.0;" x1="44" x2="44" y1="81.2969" y2="796.3594"/><line class="s_181818_e7e7e7" style="stroke-width:0.5;fill:none;stroke-dasharray:5.0,5.0;" x1="134" x2="134" y1="81.2969" y2="796.3594"/><line class="s_181818_e7e7e7" style="stroke-width:0.5;fill:none;stroke-dasharray:5.0,5.0;" x1="351" x2="351" y1="81.2969" y2="796.3594"/><line class="s_181818_e7e7e7" style="stroke-width:0.5;fill:none;stroke-dasharray:5.0,5.0;" x1="429" x2="429" y1="81.2969" y2="796.3594"/><text class="f_000000_ffffff" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="42" x="20" y="77.9951">Timer</text><ellipse class="s_181818_e7e7e7" cx="44" cy="13.5" fill="#E2E2F0" rx="8" ry="8" style="stroke-width:0.5;"/><path class="s_181818_e7e7e7" d="M44,21.5 L44,48.5 M31,29.5 L57,29.5 M44,48.5 L31,63.5 M44,48.5 L57,63.5 " fill="none" style="stroke-width:0.5;"/><text class="f_000000_ffffff" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="42" x="20" y="808.3545">Timer</text><ellipse class="s_181818_e7e7e7" cx="44" cy="820.1563" fill="#E2E2F0" rx="8" ry="8" style="stroke-width:0.5;"/><path class="s_181818_e7e7e7" d="M44,828.1563 L44,855.1563 M31,836.1563 L57,836.1563 M44,855.1563 L31,870.1563 M44,855.1563 L57,870.1563 " fill="none" style="stroke-width:0.5;"/><rect class="s_181818_e7e7e7" fill="#E2E2F0" height="30.2969" rx="2.5" ry="2.5" style="stroke-width:0.5;" width="112" x="78" y="50"/><text class="f_000000_ffffff" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="98" x="85" y="69.9951">Task Manager</text><rect class="s_181818_e7e7e7" fill="#E2E2F0" height="30.2969" rx="2.5" ry="2.5" style="stroke-width:0.5;" width="112" x="78" y="795.3594"/><text class="f_000000_ffffff" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="98" x="85" y="815.3545">Task Manager</text><text class="f_000000_ffffff" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="74" x="311" y="77.9951">Permit DB</text><path class="s_181818_e7e7e7" d="M333,29 C333,19 351,19 351,19 C351,19 369,19 369,29 L369,55 C369,65 351,65 351,65 C351,65 333,65 333,55 L333,29 " fill="#E2E2F0" style="stroke-width:1.5;"/><path class="s_181818_e7e7e7" d="M333,29 C333,39 351,39 351,39 C351,39 369,39 369,29 " fill="none" style="stroke-width:1.5;"/><text class="f_000000_ffffff" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="74" x="311" y="808.3545">Permit DB</text><path class="s_181818_e7e7e7" d="M333,821.6563 C333,811.6563 351,811.6563 351,811.6563 C351,811.6563 369,811.6563 369,821.6563 L369,847.6563 C369,857.6563 351,857.6563 351,857.6563 C351,857.6563 333,857.6563 333,847.6563 L333,821.6563 " fill="#E2E2F0" style="stroke-width:1.5;"/><path class="s_181818_e7e7e7" d="M333,821.6563 C333,831.6563 351,831.6563 351,831.6563 C351,831.6563 369,831.6563 369,821.6563 " fill="none" style="stroke-width:1.5;"/><rect class="s_181818_e7e7e7" fill="#E2E2F0" height="30.2969" rx="2.5" ry="2.5" style="stroke-width:0.5;" width="57" x="401" y="50"/><text class="f_000000_ffffff" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="43" x="408" y="69.9951">TaskN</text><rect class="s_181818_e7e7e7" fill="#E2E2F0" height="30.2969" rx="2.5" ry="2.5" style="stroke-width:0.5;" width="57" x="401" y="795.3594"/><text class="f_000000_ffffff" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="43" x="408" y="815.3545">TaskN</text><rect class="f_ffffff_000000 s_181818_e7e7e7" height="570.3984" style="stroke-width:1.0;" width="10" x="129" y="112.4297"/><rect class="f_ffffff_000000 s_181818_e7e7e7" height="59.3984" style="stroke-width:1.0;" width="10" x="129" y="711.9609"/><rect class="f_ffffff_000000 s_181818_e7e7e7" height="398.4688" style="stroke-width:1.0;" width="10" x="424.5" y="388.8906"/><polygon class="f_181818_e7e7e7 s_181818_e7e7e7" points="117,108.4297,127,112.4297,117,116.4297,121,112.4297" style="stroke-width:1.0;"/><line class="s_181818_e7e7e7" style="stroke-width:1.0;" x1="44" x2="123" y1="112.4297" y2="112.4297"/><text class="f_000000_ffffff" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="37" x="51" y="107.3638">check</text><polygon class="f_181818_e7e7e7 s_181818_e7e7e7" points="339,137.5625,349,141.5625,339,145.5625,343,141.5625" style="stroke-width:1.0;"/><line class="s_181818_e7e7e7" style="stroke-width:1.0;" x1="139" x2="345" y1="141.5625" y2="141.5625"/><text class="f_000000_ffffff" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="76" x="146" y="136.4966">Get permits</text><polygon class="f_181818_e7e7e7 s_181818_e7e7e7" points="150,166.6953,140,170.6953,150,174.6953,146,170.6953" style="stroke-width:1.0;"/><line class="s_181818_e7e7e7" style="stroke-width:1.0;stroke-dasharray:2.0,2.0;" x1="144" x2="350" y1="170.6953" y2="170.6953"/><text class="f_000000_ffffff" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="49" x="156" y="165.6294">permits</text><path class="f_eeeeee_555555 s_000000_ffffff" d="M10,185.6953 L88,185.6953 L88,192.8281 L78,202.8281 L10,202.8281 L10,185.6953 " style="stroke-width:1.5;"/><rect class="s_000000_ffffff" fill="none" height="593.6641" style="stroke-width:1.5;" width="478" x="10" y="185.6953"/><text class="f_000000_ffffff" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="33" x="25" y="198.7622">loop</text><text class="f_000000_ffffff" font-family="sans-serif" font-size="11" font-weight="bold" lengthAdjust="spacing" textLength="139" x="103" y="197.9058">[For each permit (N)]</text><line class="s_181818_e7e7e7" style="stroke-width:1.0;" x1="139" x2="181" y1="239.0938" y2="239.0938"/><line class="s_181818_e7e7e7" style="stroke-width:1.0;" x1="181" x2="181" y1="239.0938" y2="252.0938"/><line class="s_181818_e7e7e7" style="stroke-width:1.0;" x1="140" x2="181" y1="252.0938" y2="252.0938"/><polygon class="f_181818_e7e7e7 s_181818_e7e7e7" points="150,248.0938,140,252.0938,150,256.0938,146,252.0938" style="stroke-width:1.0;"/><text class="f_000000_ffffff" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="144" x="146" y="218.895">Am I the permit holder</text><text class="f_000000_ffffff" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="68" x="146" y="234.0278">for TaskN?</text><path class="f_eeeeee_555555 s_000000_ffffff" d="M58,267.0938 L124,267.0938 L124,274.2266 L114,284.2266 L58,284.2266 L58,267.0938 " style="stroke-width:1.5;"/><rect class="s_000000_ffffff" fill="none" height="387.6016" style="stroke-width:1.5;" width="420" x="58" y="267.0938"/><text class="f_000000_ffffff" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="21" x="73" y="280.1606">alt</text><text class="f_000000_ffffff" font-family="sans-serif" font-size="11" font-weight="bold" lengthAdjust="spacing" textLength="161" x="139" y="279.3042">[I am the permit holder]</text><path class="f_eeeeee_555555 s_000000_ffffff" d="M68,291.2266 L134,291.2266 L134,298.3594 L124,308.3594 L68,308.3594 L68,291.2266 " style="stroke-width:1.5;"/><rect class="s_000000_ffffff" fill="none" height="164.7344" style="stroke-width:1.5;" width="400" x="68" y="291.2266"/><text class="f_000000_ffffff" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="21" x="83" y="304.2935">alt</text><text class="f_000000_ffffff" font-family="sans-serif" font-size="11" font-weight="bold" lengthAdjust="spacing" textLength="104" x="149" y="303.437">[Status is 'idle']</text><polygon class="f_181818_e7e7e7 s_181818_e7e7e7" points="339,355.7578,349,359.7578,339,363.7578,343,359.7578" style="stroke-width:1.0;"/><line class="s_181818_e7e7e7" style="stroke-width:1.0;" x1="139" x2="345" y1="359.7578" y2="359.7578"/><text class="f_000000_ffffff" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="162" x="146" y="324.4263">Update permit for TaskN:</text><text class="f_000000_ffffff" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="141" x="146" y="339.5591">Set Status to 'running'</text><text class="f_000000_ffffff" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="158" x="146" y="354.6919">and Update Time to now</text><polygon class="f_181818_e7e7e7 s_181818_e7e7e7" points="412.5,384.8906,422.5,388.8906,412.5,392.8906,416.5,388.8906" style="stroke-width:1.0;"/><line class="s_181818_e7e7e7" style="stroke-width:1.0;" x1="139" x2="418.5" y1="388.8906" y2="388.8906"/><text class="f_000000_ffffff" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="21" x="146" y="383.8247">run</text><line class="s_000000_ffffff" style="stroke-width:1.0;stroke-dasharray:2.0,2.0;" x1="68" x2="468" y1="397.8906" y2="397.8906"/><text class="f_000000_ffffff" font-family="sans-serif" font-size="11" font-weight="bold" lengthAdjust="spacing" textLength="130" x="73" y="408.1011">[Status is 'running']</text><polygon class="f_181818_e7e7e7 s_181818_e7e7e7" points="339,443.9609,349,447.9609,339,451.9609,343,447.9609" style="stroke-width:1.0;"/><line class="s_181818_e7e7e7" style="stroke-width:1.0;" x1="139" x2="345" y1="447.9609" y2="447.9609"/><text class="f_000000_ffffff" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="162" x="146" y="427.7622">Update permit for TaskN:</text><text class="f_000000_ffffff" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="155" x="146" y="442.895">Set Update Time to now</text><line class="s_000000_ffffff" style="stroke-width:1.0;stroke-dasharray:2.0,2.0;" x1="58" x2="478" y1="463.9609" y2="463.9609"/><text class="f_000000_ffffff" font-family="sans-serif" font-size="11" font-weight="bold" lengthAdjust="spacing" textLength="189" x="63" y="474.1714">[I am not the permit holder]</text><line class="s_181818_e7e7e7" style="stroke-width:1.0;" x1="139" x2="181" y1="498.8984" y2="498.8984"/><line class="s_181818_e7e7e7" style="stroke-width:1.0;" x1="181" x2="181" y1="498.8984" y2="511.8984"/><line class="s_181818_e7e7e7" style="stroke-width:1.0;" x1="140" x2="181" y1="511.8984" y2="511.8984"/><polygon class="f_181818_e7e7e7 s_181818_e7e7e7" points="150,507.8984,140,511.8984,150,515.8984,146,511.8984" style="stroke-width:1.0;"/><text class="f_000000_ffffff" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="193" x="146" y="493.8325">Check permit holder aliveness</text><path class="f_eeeeee_555555 s_000000_ffffff" d="M68,526.8984 L134,526.8984 L134,534.0313 L124,544.0313 L68,544.0313 L68,526.8984 " style="stroke-width:1.5;"/><rect class="s_000000_ffffff" fill="none" height="120.7969" style="stroke-width:1.5;" width="400" x="68" y="526.8984"/><text class="f_000000_ffffff" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="21" x="83" y="539.9653">alt</text><text class="f_000000_ffffff" font-family="sans-serif" font-size="11" font-weight="bold" lengthAdjust="spacing" textLength="236" x="149" y="539.1089">[Current permit holder is not alive]</text><polygon class="f_181818_e7e7e7 s_181818_e7e7e7" points="339,606.5625,349,610.5625,339,614.5625,343,610.5625" style="stroke-width:1.0;"/><line class="s_181818_e7e7e7" style="stroke-width:1.0;" x1="139" x2="345" y1="610.5625" y2="610.5625"/><text class="f_000000_ffffff" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="162" x="146" y="560.0981">Update permit for TaskN:</text><text class="f_000000_ffffff" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="181" x="146" y="575.231">Set Permit Holder to myself,</text><text class="f_000000_ffffff" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="144" x="146" y="590.3638">Status to 'running' and</text><text class="f_000000_ffffff" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="130" x="146" y="605.4966">Update Time to now</text><polygon class="f_181818_e7e7e7 s_181818_e7e7e7" points="412.5,635.6953,422.5,639.6953,412.5,643.6953,416.5,639.6953" style="stroke-width:1.0;"/><line class="s_181818_e7e7e7" style="stroke-width:1.0;" x1="139" x2="418.5" y1="639.6953" y2="639.6953"/><text class="f_000000_ffffff" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="21" x="146" y="634.6294">run</text><polygon class="f_181818_e7e7e7 s_181818_e7e7e7" points="55,678.8281,45,682.8281,55,686.8281,51,682.8281" style="stroke-width:1.0;"/><line class="s_181818_e7e7e7" style="stroke-width:1.0;stroke-dasharray:2.0,2.0;" x1="49" x2="133" y1="682.8281" y2="682.8281"/><text class="f_000000_ffffff" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="32" x="61" y="677.7622">done</text><polygon class="f_181818_e7e7e7 s_181818_e7e7e7" points="150,707.9609,140,711.9609,150,715.9609,146,711.9609" style="stroke-width:1.0;"/><line class="s_181818_e7e7e7" style="stroke-width:1.0;stroke-dasharray:2.0,2.0;" x1="144" x2="423.5" y1="711.9609" y2="711.9609"/><text class="f_000000_ffffff" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="32" x="156" y="706.895">done</text><polygon class="f_181818_e7e7e7 s_181818_e7e7e7" points="339,767.3594,349,771.3594,339,775.3594,343,771.3594" style="stroke-width:1.0;"/><line class="s_181818_e7e7e7" style="stroke-width:1.0;" x1="134" x2="345" y1="771.3594" y2="771.3594"/><text class="f_000000_ffffff" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="162" x="141" y="736.0278">Update permit for TaskN:</text><text class="f_000000_ffffff" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="143" x="141" y="751.1606">Set Status to 'idle' and</text><text class="f_000000_ffffff" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="130" x="141" y="766.2935">Update Time to now</text><!--MD5=[0149ddbf569105100c59061d25e63485]
@startuml
'https://plantuml.com/sequence-diagram

actor "Timer" as timer
participant "Task Manager" as taskMgr
database "Permit DB" as taskDB
participant "TaskN" as task

timer -> taskMgr: check

activate taskMgr

taskMgr -> taskDB: Get permits
taskDB - -> taskMgr: permits

loop For each permit (N)

taskMgr -> taskMgr: Am I the permit holder\nfor TaskN?

alt I am the permit holder
  alt Status is 'idle'
    taskMgr -> taskDB: Update permit for TaskN:\nSet Status to 'running'\nand Update Time to now
    taskMgr -> task: run
    activate task
  else Status is 'running'
      taskMgr -> taskDB: Update permit for TaskN:\nSet Update Time to now
  end
else I am not the permit holder
  taskMgr -> taskMgr: Check permit holder aliveness

  alt Current permit holder is not alive
    taskMgr -> taskDB: Update permit for TaskN:\nSet Permit Holder to myself,\nStatus to 'running' and\nUpdate Time to now
    taskMgr -> task: run
  end
end

timer <- - taskMgr: done

deactivate taskMgr

task - -> taskMgr: done

activate taskMgr
  taskMgr -> taskDB: Update permit for TaskN:\nSet Status to 'idle' and\nUpdate Time to now
deactivate taskMgr

end loop
@enduml

@startuml

actor "Timer" as timer
participant "Task Manager" as taskMgr
database "Permit DB" as taskDB
participant "TaskN" as task

timer -> taskMgr: check

activate taskMgr

taskMgr -> taskDB: Get permits
taskDB - -> taskMgr: permits

loop For each permit (N)

taskMgr -> taskMgr: Am I the permit holder\nfor TaskN?

alt I am the permit holder
  alt Status is 'idle'
    taskMgr -> taskDB: Update permit for TaskN:\nSet Status to 'running'\nand Update Time to now
    taskMgr -> task: run
    activate task
  else Status is 'running'
      taskMgr -> taskDB: Update permit for TaskN:\nSet Update Time to now
  end
else I am not the permit holder
  taskMgr -> taskMgr: Check permit holder aliveness

  alt Current permit holder is not alive
    taskMgr -> taskDB: Update permit for TaskN:\nSet Permit Holder to myself,\nStatus to 'running' and\nUpdate Time to now
    taskMgr -> task: run
  end
end

timer <- - taskMgr: done

deactivate taskMgr

task - -> taskMgr: done

activate taskMgr
  taskMgr -> taskDB: Update permit for TaskN:\nSet Status to 'idle' and\nUpdate Time to now
deactivate taskMgr

end loop
@enduml

PlantUML version 1.2022.2beta5(Unknown compile time)
(GPL source distribution)
Java Runtime: Java(TM) SE Runtime Environment
JVM: Java HotSpot(TM) 64-Bit Server VM
Default Encoding: UTF-8
Language: en
Country: US
--></g></svg>